<!DOCTYPE html>
<html lang="kr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Combine Framework - Seorenn Static Pages</title>
<meta name="generator" content="Org mode">
<meta name="author" content="Heeseung Seo (Seorenn)">
<meta name="description" content="Combine Framework(컴바인 프레임워크)에 대한 간략한 가이드">
<meta name="keywords" content="swift, combine, rx, reactive, framework, rxcocoa">
<meta property="og:title" content="Combine Framework" />
<meta property="og:description" content="Combine Framework(컴바인 프레임워크)에 대한 간략한 가이드" />
<meta property="og:type" content="website" />
<meta property="og:image" content="https://seorenn.github.io/img/seorenn-logo.png" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Combine Framework" />
<meta name="twitter:description" content="Combine Framework(컴바인 프레임워크)에 대한 간략한 가이드" />
<meta name="twitter:image" content="https://seorenn.github.io/img/seorenn-logo.png" />
<meta name="twitter:site" content="@seorenn" />
<meta name="twitter:creator" content="@seorenn" />
<link rel="stylesheet" type="text/css" href="/static/style.css"/>
<link rel="shortcut icon" type="image/x-icon" href="favicon.ico"/>
<link rel="canonical" href="https://seorenn.github.io/combine-framework.html"/>
<link property="og:url" href="https://seorenn.github.io/combine-framework.html"/>
<meta name="google-site-verification" content="YqTFZuthbvGIlDE1dhxiTjZ3m-GfyNs_rsHaOlPKpug" />
<meta name="naver-site-verification" content="ebf6a89968fd9f447c1a77d83e2c4aa9bdbb0345"/>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-44534026-1"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-44534026-1');
</script>
</head>
<body>
<script data-ad-client="ca-pub-1071465863344332" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<div id="content">
<header>
<h1 class="title">Combine Framework</h1>
<h2><a href="/">Seorenn Static Pages</a></h2></header><nav id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org8d16c78">이게 뭘까?</a></li>
<li><a href="#org61ddb9c">다짜고짜 예제부터</a></li>
<li><a href="#orgbaacbfc">Publisher and Subscriber</a></li>
<li><a href="#org4fcb61a">Subject</a></li>
<li><a href="#org5bbdfd3">마무리</a></li>
<li><a href="#org5212fd4">관련글</a></li>
</ul>
</div>
</nav>

<div id="outline-container-org8d16c78" class="outline-2">
<h2 id="org8d16c78">이게 뭘까?</h2>
<div class="outline-text-2" id="text-org8d16c78">
<p>
Combine 은 이벤트 처리 오퍼레이터를 조합하여 만든 비동기 이벤트 처리 프레임워크
입니다. 근데 이건 좀 어려운 이야기고, 보통은 Rx 라는 것이 사용하던 반응형(Reactive)
프로그래밍 라이브러리라는 표현이 더 쉬운 표현 같습니다.
</p>

<p>
어쨌든 이름이나 간략한 설명 만으로는 도저히 이해는 안 되는게 정상입니다.
</p>

<blockquote>
<p>
참고로 이 글은 Rx 를 모르는 사람이 쓰는 Combine 글입니다.
</p>
</blockquote>

<p>
우선 코드부터 시작합시다.
</p>
<div class="org-src-container">
<pre class="src src-swift"><span style="color: #51afef;">import</span> Combine
</pre>
</div>
<p>
네. Combine 은 프레임워크입니다. 그래서 임포트해야 쓸 수 있습니다.
그래서 어쩌라는 거냐구요?
</p>
</div>
</div>
<div id="outline-container-org61ddb9c" class="outline-2">
<h2 id="org61ddb9c">다짜고짜 예제부터</h2>
<div class="outline-text-2" id="text-org61ddb9c">
<p>
일단 아래 예제를 살펴봅시다.
</p>
<div class="org-src-container">
<pre class="src src-swift"><span style="color: #51afef;">let</span> _ = <span style="color: #c678dd;">Just</span>(<span style="color: #da8548; font-weight: bold;">10</span>)
    .<span style="color: #c678dd;">map</span> { value -&gt; <span style="color: #c678dd;">Int</span> <span style="color: #51afef;">in</span>
        <span style="color: #51afef;">return</span> value * <span style="color: #da8548; font-weight: bold;">2</span>
    }
    .<span style="color: #dcaeea;">sink</span> { value <span style="color: #51afef;">in</span>
        <span style="color: #c678dd;">print</span>(<span style="color: #98be65;">"Finished with value \(</span>value<span style="color: #98be65;">)"</span>)
    }
</pre>
</div>
<p>
이 코드가 실행되면 어이없게도(?) <code>Finished with value 20</code> 이라는 결과가 찍히고
종료됩니다. 마치 <code>map</code> 안의 내용과 <code>sink</code> 의 내용이 순차적으로 실행된 것 처럼요.
</p>

<p>
각 단계에서의 정확한 타입을 살펴보면 아래와 같습니다.
</p>
<ul class="org-ul">
<li><code>Just</code> 는 <code>Publisher</code> 프로토콜을 따르는 값(구조체) 타입</li>
<li><code>map</code> 은 <code>Publisher</code> 를 따르는 <code>Just</code> 타입 인스턴스를 리턴</li>
<li><code>sink</code> 는 <code>AnyCancellable</code> 타입 인스턴스를 리턴</li>
</ul>
<p>
일단 여기서 Publisher 라는 명칭이 등장합니다.
</p>
</div>
</div>
<div id="outline-container-orgbaacbfc" class="outline-2">
<h2 id="orgbaacbfc">Publisher and Subscriber</h2>
<div class="outline-text-2" id="text-orgbaacbfc">
<p>
컴바인의 개념 중 가장 중요한 것은 퍼블리셔(Publisher)와
서브스크라이버(Subscriber)입니다.
</p>

<p>
퍼블리셔는 데이터를 제공하는 역할입니다. 컴바인에서는 다양한 퍼블리셔 타입을
제공하는데 예제에 나오는 <code>Just</code> 는 1회성 데이터를 제공하기 위한 퍼블리셔입니다.
이런 퍼블리셔는 누군가에게 데이터를 전달하는 위한 목적으로 존재합니다.
</p>

<p>
그리고 이런 퍼블리셔끼리 연결된 체인의 끝에는 서브스크라이버가 존재하며 최종적으로
데이터를 전달받게 됩니다. 즉 예제의 코드는 <code>Just(10)</code> 이라는 데이터가 <code>map</code> 에 전달되어서
다시 <code>Just(20)</code> 으로 가공되고 이것이 <code>sink</code> 로 전달됩니다. 결과적으로 <code>sink</code> 가
서버스크라이버 역할이라는 것을 알 수 있습니다.
</p>

<p>
여기까지만 보면 그냥 데이터의 흐름을 정의하는 것으로도 보이는데 그다지
반응형과는 관계가 없는 것 같습니다. 하지만
만약 퍼블리셔의 값이 변경될 수 있다면 어떻게 될까요? 퍼블리셔의 값이
변경되면 자동으로 체인에 연결된 각종 코드가 실행되게 될까요? 네. 반응형이란게
바로 그런걸 의미하니깐요.
</p>
</div>
</div>
<div id="outline-container-org4fcb61a" class="outline-2">
<h2 id="org4fcb61a">Subject</h2>
<div class="outline-text-2" id="text-org4fcb61a">
<p>
컴바인에는 서브젝트(Subject)라는 특수한 타입도 존재합니다.
이 타입은 외부에서 데이터를 전달할 수 있는 특수한 퍼블리셔입니다.
어디선가는 퍼블리셔이면서 서브스크라이버로 될 수 있다는 식으로 설명하곤 합니다만
현재 상황에선 이 말은 이해하기 힘드니 퍼블리셔 입장에서만 살펴봅시다.
</p>

<p>
Subject 를 만족하는 기본 타입 중 <code>PassthroughSubject</code> 를 사용하는 예입니다.
</p>
<div class="org-src-container">
<pre class="src src-swift"><span style="color: #51afef;">let</span> p = PassthroughSubject&lt;<span style="color: #c678dd;">Int</span>, <span style="color: #c678dd;">Never</span>&gt;()
<span style="color: #51afef;">let</span> s = p.<span style="color: #dcaeea;">sink</span> { value <span style="color: #51afef;">in</span>
    <span style="color: #c678dd;">print</span>(<span style="color: #98be65;">"finished with \(</span>value<span style="color: #98be65;">)"</span>)
}

p.<span style="color: #c678dd;">send</span>(<span style="color: #da8548; font-weight: bold;">10</span>)
p.<span style="color: #c678dd;">send</span>(<span style="color: #da8548; font-weight: bold;">20</span>)
</pre>
</div>
<p>
<code>PassthroughSubject</code> 는 이름처럼 데이터를 체인에 던져주기만 하는 서브젝트입니다.
서브젝트가 가지는 공통적인 메소드로 <code>send</code> 가 있는데 이걸 이용하면 데이터가
체인에 뿌려지게 됩니다.
</p>

<p>
그래서 이 타입의 퍼블리셔에게 <code>send(10)</code> 을 던지면 바로 'finished with 10'
이라는 메시지가 출력됩니다. 마찬가지로 <code>send(20)</code> 이 실행되면 'finished with 20'
이 콘솔에 표시됩니다.
</p>

<p>
다른 예제와는 다르게 <code>s</code> 라는 변수에 서브스크라이버를 받아둔 이유는 이
서브스크라이버가 자동으로 메모리에서 해제되지 않게 붙잡아두기 위함입니다.
</p>

<p>
이 정도면 어느정도 반응하는 모습을 볼 수 있는 최소한의 예가 될 수 있을지도 모르겠습니다.
</p>
</div>
</div>
<div id="outline-container-org5bbdfd3" class="outline-2">
<h2 id="org5bbdfd3">마무리</h2>
<div class="outline-text-2" id="text-org5bbdfd3">
<p>
컴바인은 이렇게 퍼블리셔와 서브스크라이버 개념을 제공하고 이를 이용한 비동기
이벤트 프로세싱을 할 수 있게 기본을 구축해주는 프레임워크입니다.
가장 간단한 부분만을 간략하게 설명하는데 이 정도 분량이
필요하네요. 사실 쉽다면 쉽겠지만 방대하다면 또 방대한 것이 바로 이 반응형
프로그래밍입니다.
</p>

<p>
물론 RxSwift 같은 것에 익숙하다면 굉장히 쉽게 이해하고 바로
사용했을지도 모르겠지요. 하지만 저는 모르기 때문에 이해하기가 참 어려웠습니다.
이 글을 쓰면서 비로소 아주 기초적인 부분이 이해되기 시작했습니다.
</p>

<p>
컴바인과 관련된 글은 이 글 이후에도 계속 만들어 나갈 예정입니다. 아직 내용이
부족하니깐요. 저도 공부가 필요하고&#x2026; 아래 관련글을 계속 살펴봐주세요.
</p>
</div>
</div>
<div id="outline-container-org5212fd4" class="outline-2">
<h2 id="org5212fd4">관련글</h2>
<div class="outline-text-2" id="text-org5212fd4">
<ul class="org-ul">
<li><a href="./swift.html">Swift</a></li>
<li><a href="swiftui-combine.html">SwiftUI + Combine</a></li>
</ul>
</div>
</div>
<div id="footer"><div id="time">2019년 12월 23일 마지막으로 수정됨</div><div id="copyright">Copyright 2019 Heeseung Seo (Seorenn)</div></div></div>
</body>
</html>
