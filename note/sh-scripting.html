<!DOCTYPE html><html lang="ko"><head><meta charset="utf-8"><meta name="viewport"content="width=device-width,initial-scale=1"><meta http-equiv="Content-Type"content="text/html; charset=UTF-8"><link rel="stylesheet"href="/static/style.min.css"><meta name="battery-savings"content="allow-reduced-framerate allow-reduced-script-speed"><title>Bourne Shell 스크립트 정리 - Seorenn Note</title><meta name="twitter:title"content="Bourne Shell 스크립트 정리"><meta name="og:title"content="Bourne Shell 스크립트 정리"><meta name="description"content="필요할 때마다 정리하는 본 셸 스크립트 문법 및 팁"><meta name="twitter:description"content="필요할 때마다 정리하는 본 셸 스크립트 문법 및 팁"><meta name="og:description"content="필요할 때마다 정리하는 본 셸 스크립트 문법 및 팁"><link rel="canonical"href="https://seorenn.github.io/note/sh-scripting.html"><meta property="og:url"content="https://seorenn.github.io/note/sh-scripting.html"><link rel="shortcut icon"type="image/x-icon"href="/static/favicon.ico"><meta name="twitter:image"content="https://seorenn.github.io/static/seorenn-symbol.png"><meta property="og:image"content="https://seorenn.github.io/static/seorenn-symbol.png"><meta property="og:image:width"content="520"><meta property="og:image:height"content="329"><meta name="twitter:card"content="summary"><meta name="twitter:site"content="@seorenn"><meta name="twitter:creator"content="@seorenn"><meta property="og:type"content="article"><meta property="og:site_name"content="Seorenn"><meta property="og:locale"content="ko_KR"><meta name="referrer"content="unsafe-url"><meta name="robots"content="follow,index"><meta name="google-site-verification"content="YqTFZuthbvGIlDE1dhxiTjZ3m-GfyNs_rsHaOlPKpug"><meta name="naver-site-verification"content="24609571c04926ab1220d5d02610efa1c9e12221"><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1071465863344332"crossorigin="anonymous"></script></head><body><div class="header-content"><header class="top-header"><div class="logo-container"><span class="vertical-center-helper"></span> <a href="/"title="Seorenn"><img class="site-logo"src="/static/seorenn-note-logo-light.png"alt="Seorenn Note"></a><nav><span class="vertical-center-helper"></span> <a href="/"title="Home">HOME</a> | <a href="/note"title="All Notes">NOTES</a></nav></div></header></div><div class="content-container"><section class="content"><div class="mid-ad-container"><ins class="adsbygoogle mid-ad"style="display:block"data-ad-client="ca-pub-1071465863344332"data-ad-slot="4306465772"data-ad-format="auto"data-full-width-responsive="true"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><header><h1>Bourne Shell 스크립트 정리</h1><div class="title-date">2020년 7월 17일 수정</div></header><div id="table-of-contents"role="doc-toc"><h2>≡ 목차 (Table of Contents)</h2><div id="text-table-of-contents"role="doc-toc"><ul><li><a href="#e6653a51">셸 스크립트 실행하기</a></li><li><a href="#fae82bc9">스크립트를 실행 가능하게 만들기</a></li><li><a href="#972ceb7c">if문 정리</a></li><li><a href="#13ba80d2">루프(Loop)</a></li><li><a href="#86e6abb0">조건식 오퍼레이터</a></li><li><a href="#57411cf4">디렉토리 존재 유무 체크</a></li><li><a href="#d8571379">셸 스크립트에서 파일 개수 구하기</a></li><li><a href="#c79d2fcc">스크립트 실행 파라미터(Parameter)</a></li><li><a href="#31d0cbca">와일드카드 파라미터 처리</a></li><li><a href="#c0d7552e">셸 스크립트 동작에 에러가 나면 멈추게 하기</a></li><li><a href="#1ad00c69">스크립트에서 실행하는 커맨드의 에러 메시지 숨기기</a></li></ul></div></div><p>이 글은 <a href="sh.html">Bourne Shell</a> 스크립트 문법 및 팁에 대해 전반적인 기준 없이 그냥 정리하는 글이다. 중구난방이고 개인적인 필요에 의해 업데이트 된다는 점에 유의하자.</p><div id="outline-container-e6653a51"class="outline-2"><h2 id="e6653a51">셸 스크립트 실행하기</h2><div class="outline-text-2"id="text-e6653a51"><p>일반적으로 셸 스크립트를 만들면 <a href="shell.html">셸</a>을 이용해 실행하는 것이 보통이다.</p><div class="org-src-container"><pre class="src src-bash">sh ./somescript.sh
</pre></div><p>이 외에도 여러 실행 방법이 있다. 예를 들어</p><div class="org-src-container"><pre class="src src-bash"><span style="color:#c678dd">source</span> somescript.sh
</pre></div><p>이렇게 하거나 혹은</p><div class="org-src-container"><pre class="src src-bash">. ./somescript.sh
</pre></div><p>이렇게 해도 스크립트가 실행된다.</p></div></div><div id="outline-container-fae82bc9"class="outline-2"><h2 id="fae82bc9">스크립트를 실행 가능하게 만들기</h2><div class="outline-text-2"id="text-fae82bc9"><p>만약 스크립트를 별도의 명령 없이 직접 파일 이름으로 실행되게 하고자 한다면 스크립트 제일 상단에 아래와 같이 실행 정보를 표기하는 주석문을 작성하자.</p><div class="org-src-container"><pre class="src src-bash"><span style="color:#5b6268">#</span><span style="color:#5b6268">!/bin/</span><span style="color:#51afef">sh</span>
</pre></div><p><code>#</code> 으로 시작되는 구문은 원래 주석이기 때문에 실행 자체에 영향을 끼치진 않는다. 다만 유닉스에서 유래한 OS에서 스크립트의 첫 줄의 <code>#!</code> 은 해당 스크립트를 실행시키는 인터프리터나 셸의 경로를 적는 공간이다.</p><p>이제 실행 퍼미션을 주자. 예제는 스크립트 파일 이름이 <code>somescript.sh</code> 라고 가정한다.</p><div class="org-src-container"><pre class="src src-bash"><span style="color:#ecbe7b">chmod</span> a+x somescript.sh
</pre></div><p>이렇게 하면 이 파일은 모든 사용자에게 실행(x) 권한이 주어진다.</p><p>이제 아래와 같은 명령으로 실행할 수 있다.</p><div class="org-src-container"><pre class="src src-bash">./somescript.sh
</pre></div><p>이런 식으로 실행시킬 <a href="shell.html">셸</a>을 명시해서 스크립트가 바로 실행되게 만들 수 있다.</p><p>참고로 이런 스크립트를 실행시키는 바이너리 정보 기입 법은 보통은 아래와 같은 스타일을 추천한다.</p><div class="org-src-container"><pre class="src src-bash"><span style="color:#5b6268">#</span><span style="color:#5b6268">!/usr/bin/</span><span style="color:#51afef">env</span><span style="color:#5b6268"> sh</span>
</pre></div><p><code>env</code> 라는 도구는 매개변수로 넘긴 도구가 어디에 있는지 찾아서 그 경로를 치환 시키는 도구다. 물론 sh가 아닌 <code>bash</code> 같은 셸을 명시해도 잘 동작해야 정상이다.</p><p>이후 PATH 환경 변수에 등록된 디렉터리로 옮기거나 해서 좀 더 쉽게 실행시킬 수 있게도 할 수 있다. 필요 없다면 확장자 <code>.sh</code> 를 빼버려도 유닉스나 리눅스, <a href="macos.html">macOS</a> 등에선 실행에 아무런 문제가 없다.</p></div></div><div id="outline-container-972ceb7c"class="outline-2"><h2 id="972ceb7c">if문 정리</h2><div class="outline-text-2"id="text-972ceb7c"><p>조건을 통해 분기를 정하는 스크립트에서 가장 중요한 부분이라고 볼 수 있는 문법이다. 대충 아래와 같은 식으로 사용한다.</p><div class="org-src-container"><pre class="src src-bash"><span style="color:#51afef">if</span> <span style="color:#51afef">[</span> condition <span style="color:#51afef">]</span>
<span style="color:#51afef">then</span>
    ...
<span style="color:#51afef">else</span>
    ...
<span style="color:#51afef">fi</span>
</pre></div><p>한 줄로 쓸 때는 세미콜론을 잘 쓰면 된다.</p><div class="org-src-container"><pre class="src src-bash"><span style="color:#51afef">if</span> <span style="color:#51afef">[</span> condition <span style="color:#51afef">]</span> ; <span style="color:#51afef">then</span> foo bar; <span style="color:#51afef">fi</span>;
</pre></div><p>조건을 반대로 뒤집을 때(NOT)는 조건 앞에 <code>!</code> 을 쓰면 된다.</p><div class="org-src-container"><pre class="src src-bash"><span style="color:#51afef">if</span> <span style="color:#51afef">[</span> <span style="color:#51afef;font-weight:700">!</span> condition <span style="color:#51afef">]</span>; <span style="color:#51afef">then</span> foo bar; <span style="color:#51afef">fi</span>;
</pre></div><p>AND 혹은 OR 조건은 몇 가지 방법이 있지만 아래의 예 하나만 보자.</p><div class="org-src-container"><pre class="src src-bash"><span style="color:#51afef">if</span> <span style="color:#51afef">{</span> <span style="color:#c678dd">[</span> condition1 <span style="color:#c678dd">]</span> &amp;&amp; <span style="color:#c678dd">[</span> condition2 <span style="color:#c678dd">]</span> ;<span style="color:#51afef">}</span> || <span style="color:#51afef">[</span> condition3 <span style="color:#51afef">]</span> ; <span style="color:#51afef">then</span>
    ...
<span style="color:#51afef">fi</span>
</pre></div><p>위 코드는 AND 체크하는 두 식을 중괄호를 이용해 묶은 형태다. 즉 기성 언어라면 <code>(c1 &amp;&amp; c2) || c3</code> 이렇게 표현했을 식이라고 볼 수 있다. 세미콜론의 위치를 잘 보자.</p></div></div><div id="outline-container-13ba80d2"class="outline-2"><h2 id="13ba80d2">루프(Loop)</h2><div class="outline-text-2"id="text-13ba80d2"><p><code>for</code> 문을 이용한 현대적인(?) 루프는 아래처럼 쓸 수 있다.</p><div class="org-src-container"><pre class="src src-bash"><span style="color:#dcaeea">VALUES</span>=<span style="color:#98be65">"a\nb\nc"</span>
<span style="color:#51afef">for</span> VALUE<span style="color:#51afef"> in</span> $<span style="color:#dcaeea">VALUES</span>; <span style="color:#51afef">do</span>
    <span style="color:#ecbe7b">echo</span> $<span style="color:#dcaeea">VALUE</span>
<span style="color:#51afef">done</span>
</pre></div><p><code>VALUES</code> 라는 변수의 값은 세 줄로 이루어진 문자열 데이터다. <code>\n</code> 은 개행문자다. 그리고 위 예제의 <code>for</code> 문은 각 라인마다 한 줄 씩 동작한다. 즉 출력은 a, b, c가 차례대로 각 한 줄 마다 표시된다.</p><p>그리고 <a href="c-language.html">C 언어</a> 방식의 for 루프를 비슷하게 구현할 수도 있다.</p><div class="org-src-container"><pre class="src src-bash"><span style="color:#51afef">for</span> <span style="color:#51afef">(</span><span style="color:#c678dd">(</span> <span style="color:#dcaeea">i</span>=<span style="color:#da8548;font-weight:700">0</span>; i &lt; <span style="color:#da8548;font-weight:700">10</span>; i++ <span style="color:#c678dd">)</span><span style="color:#51afef">)</span>
<span style="color:#51afef">do</span>
    <span style="color:#ecbe7b">echo</span> <span style="color:#98be65">"</span><span style="color:#a9a1e1">$</span><span style="color:#dcaeea">i</span><span style="color:#98be65">"</span>
<span style="color:#51afef">done</span>
</pre></div><p>위의 코드는 0에서 9까지의 숫자를 콘솔에 표시한다.</p></div></div><div id="outline-container-86e6abb0"class="outline-2"><h2 id="86e6abb0">조건식 오퍼레이터</h2><div class="outline-text-2"id="text-86e6abb0"><p>조건문에 사용하는 몇 가지 논리 오퍼레이터를 정리해보자.</p><dl class="org-dl"><dt><code>=</code>, <code>!=</code></dt><dd>문자열이 동일한지, 동일하지 않은지</dd><dt><code>-eq</code>, <code>-ne</code>, <code>-gt</code>, <code>-ge</code>, <code>-lt</code>, <code>-le</code></dt><dd>차례대로 equal, not equal, greater than, greater than or equal, less than, less than or equal</dd><dt><code>-a</code>, <code>-o</code></dt><dd>AND와 OR</dd><dt><code>-z</code>, <code>-n</code></dt><dd>차례대로 문자열의 길이가 0(zero), 반대로 그 이상(not null)</dd><dt><code>-d</code>, <code>-e</code>, <code>-f</code></dt><dd>디렉토리가 존재하는지, 파일이 존재하는지, 문자열이 파일인지</dd><dt><code>-L</code>, <code>-r</code>, <code>-w</code></dt><dd>링크인지, 읽기 가능한지, 쓰기 가능한지</dd><dt><code>-s</code></dt><dd>파일 크기가 0 이상인지</dd><dt><code>-x</code></dt><dd>파일이 실행 가능한지</dd><dt><code>-nt</code>, <code>-ot</code>, <code>-ef</code></dt><dd>왼쪽 파일이 오른쪽 파일보다 최신인지, 과거인지, 같은 파일인지</dd></dl></div></div><div id="outline-container-57411cf4"class="outline-2"><h2 id="57411cf4">디렉토리 존재 유무 체크</h2><div class="outline-text-2"id="text-57411cf4"><p>위에서도 정리했지만 <code>-d</code> 플래그를 쓸 수 있다.</p><div class="org-src-container"><pre class="src src-bash"><span style="color:#51afef">if</span> <span style="color:#51afef">[</span> -d <span style="color:#98be65">"/foo/bar/"</span> <span style="color:#51afef">]</span> ; <span style="color:#51afef">then</span>
    ...
<span style="color:#51afef">fi</span>
</pre></div><p>반대로 파일 여부를 파악하려면 <code>-e</code> 혹은 <code>-f</code> 플래그를 쓰면 될 것 같다.</p></div></div><div id="outline-container-d8571379"class="outline-2"><h2 id="d8571379">셸 스크립트에서 파일 개수 구하기</h2><div class="outline-text-2"id="text-d8571379"><p>특정 디렉터리 안의 파일 갯수를 구하는 것은 바로는 안 되고 각 유틸리티를 이용한 결과를 얻어서 사용한다.</p><div class="org-src-container"><pre class="src src-bash"><span style="color:#dcaeea">COUNT</span>=$<span style="color:#51afef">(</span><span style="color:#ecbe7b">ls</span> /foo/bar | wc -l<span style="color:#51afef">)</span>
</pre></div><p>참고로 위 코드는 백쿼트(back-quote) <code>`</code> 를 사용하는 것과 비슷한 방식의 커맨드다. 즉 <code>ls /foo/bar | wc -l</code> 커맨드의 실행 결과가 위 변수에 주입된다.</p><p>위 결과를 이용해 파일이 하나 이상 존재하는지 체크하려면</p><div class="org-src-container"><pre class="src src-bash"><span style="color:#51afef">if</span> <span style="color:#51afef">[</span> <span style="color:#98be65">"</span><span style="color:#a9a1e1">$</span><span style="color:#dcaeea">COUNT</span><span style="color:#98be65">"</span> -gt <span style="color:#da8548;font-weight:700">0</span> <span style="color:#51afef">]</span> ; <span style="color:#51afef">then</span>
    <span style="color:#5b6268"># </span><span style="color:#5b6268">&#54028;&#51068;&#51060; &#54616;&#45208; &#51060;&#49345; &#51316;&#51116;&#54616;&#45716; &#44221;&#50864;</span>
<span style="color:#51afef">fi</span>
</pre></div><p>이런 식으로 쓸 수 있다.</p></div></div><div id="outline-container-c79d2fcc"class="outline-2"><h2 id="c79d2fcc">스크립트 실행 파라미터(Parameter)</h2><div class="outline-text-2"id="text-c79d2fcc"><p>실행 파라미터(Parameter), 프로그래밍 언어에서는 매개변수라고 부르지만 여기서는 실행 옵션이라는 의미가 더 와닿는 것 같다. 스크립팅시에는 대충 아래의 키워드가 쓰인다.</p><dl class="org-dl"><dt><code>$#</code></dt><dd>파라미터 개수</dd><dt><code>$@</code></dt><dd>파라미터 전체</dd><dt><code>$0</code></dt><dd>실행 명령 이름, 즉 스크립트 파일 이름</dd><dt><code>$1</code></dt><dd>첫 번째 파라미터</dd><dt><code>$2</code></dt><dd>두 번째 파라미터 (이런 식으로 계속 숫자를 불리면 된다)</dd></dl><p>위의 방법과 조합해서 리스트 형태로 받아서 사용하는 방법도 있다.</p><div class="org-src-container"><pre class="src src-bash"><span style="color:#dcaeea">args</span>=<span style="color:#51afef">(</span><span style="color:#98be65">"</span><span style="color:#a9a1e1">$</span><span style="color:#dcaeea">@</span><span style="color:#98be65">"</span><span style="color:#51afef">)</span>
<span style="color:#51afef">for</span> <span style="color:#51afef">(</span><span style="color:#c678dd">(</span> <span style="color:#dcaeea">i</span>=<span style="color:#da8548;font-weight:700">0</span>; i &lt; $<span style="color:#dcaeea">#</span>; i++ <span style="color:#c678dd">)</span><span style="color:#51afef">)</span>
<span style="color:#51afef">do</span>
    <span style="color:#dcaeea">param</span>=$<span style="color:#51afef">{</span><span style="color:#dcaeea">args</span><span style="color:#c678dd">[</span>$<span style="color:#dcaeea">i</span><span style="color:#c678dd">]</span><span style="color:#51afef">}</span>
    <span style="color:#ecbe7b">echo</span> <span style="color:#98be65">"</span><span style="color:#a9a1e1">$</span><span style="color:#dcaeea">i</span><span style="color:#98be65"> parameter is </span><span style="color:#a9a1e1">$</span><span style="color:#dcaeea">param</span><span style="color:#98be65">"</span>
<span style="color:#51afef">done</span>
</pre></div><p><code>args</code> 를 처리하는 방법을 잘 보자.</p></div></div><div id="outline-container-31d0cbca"class="outline-2"><h2 id="31d0cbca">와일드카드 파라미터 처리</h2><div class="outline-text-2"id="text-31d0cbca"><p>셸 스크립트에 옵션으로 <code>*.ext</code> 같은 파일 이름 와일드카드를 넘겼을 때 이를 나열하는 방법을 for 커맨드로 표현하면 이렇다.</p><div class="org-src-container"><pre class="src src-bash"><span style="color:#51afef">for</span> arg<span style="color:#51afef"> in</span> <span style="color:#98be65">"</span><span style="color:#a9a1e1">$</span><span style="color:#dcaeea">@</span><span style="color:#98be65">"</span>
<span style="color:#51afef">do</span>
    <span style="color:#ecbe7b">echo</span> $<span style="color:#dcaeea">arg</span>
    ...
<span style="color:#51afef">done</span>
</pre></div><p>앞서 살펴본 모든 파라미터를 받아오는 <code>$@</code> 와 for 루프를 이용한 트릭이다.</p><p>이 경우 <code>arg</code> 에는 각 파일의 경로가 들어있다. 즉 와일드카드에 해당하는 모든 파일의 경로를 for 루프를 통해 하나하나 얻을 수 있다. 각 파일을 가공하고 싶을 때 유용하다.</p></div></div><div id="outline-container-c0d7552e"class="outline-2"><h2 id="c0d7552e">셸 스크립트 동작에 에러가 나면 멈추게 하기</h2><div class="outline-text-2"id="text-c0d7552e"><p>셸 스크립트 상단에 아래 한 줄을 넣어두면 에러가 났을 때 스크립트가 멈춘다.</p><div class="org-src-container"><pre class="src src-bash"><span style="color:#c678dd">set</span> -e
</pre></div></div></div><div id="outline-container-1ad00c69"class="outline-2"><h2 id="1ad00c69">스크립트에서 실행하는 커맨드의 에러 메시지 숨기기</h2><div class="outline-text-2"id="text-1ad00c69"><p>가끔 스크립트에서 여러 명령을 사용하는데 이 명령이 에러를 표시하는 게 보기 싫을 수도 있다. 이럴 때 에러 메시지는 <code>stderr</code> (2) 파이프로 전달되니 이것을 지옥의 쓰레기통(?)에 던지면 된다.</p><div class="org-src-container"><pre class="src src-bash">some_shell_command <span style="color:#da8548;font-weight:700">2</span>&gt; /dev/null
</pre></div><p>여기서 <code>2&gt;</code> 이 표현이 에러를 어디로 리다이렉트(redirect) 시킬지 의미하는 표현이다.</p></div></div><div class="mid-ad-container"><ins class="adsbygoogle mid-ad"style="display:block"data-ad-client="ca-pub-1071465863344332"data-ad-slot="4306465772"data-ad-format="auto"data-full-width-responsive="true"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><div class="backlinks-container"><hr><h1>이 글을 링크하는 글들</h1><div class="article-link"><div class="article-link-title-block"><h2><a class="article-link-title"href="/note/sh.html">❏ Bourne Shell</a></h2><span class="article-description">본 셸, sh, 가장 기본적인 셸(Shell)에 대한 팁 정리</span><span class="article-link-date"> Updated on 2021년 5월 5일</span></div></div></div></section></div><div class="footer-content"><footer>Copyright 2019 ~ 2020. Seorenn all rights reserved.</footer></div><script async src="https://www.googletagmanager.com/gtag/js?id=UA-44534026-1"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-44534026-1")</script></body></html>