<!DOCTYPE html>
<html lang="kr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Org 스프레드시트 - Seorenn Static Pages</title>
<meta name="generator" content="Org mode">
<meta name="author" content="Heeseung Seo (Seorenn)">
<meta name="description" content="Org Mode 문서로 스프레드시트(Spreadsheet)를 만드는 방법에 대한 가이드입니다.">
<meta name="keywords" content="org, mode, spreadsheet, excel, lotus, 스프레드시트, 엑셀, 테이블, 자동, 계산">
<meta property="og:title" content="Org 스프레드시트" />
<meta property="og:description" content="Org Mode 문서로 스프레드시트(Spreadsheet)를 만드는 방법에 대한 가이드입니다." />
<meta property="og:type" content="website" />
<meta property="og:image" content="https://seorenn.github.io/img/seorenn-logo.png" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Org 스프레드시트" />
<meta name="twitter:description" content="Org Mode 문서로 스프레드시트(Spreadsheet)를 만드는 방법에 대한 가이드입니다." />
<meta name="twitter:image" content="https://seorenn.github.io/img/seorenn-logo.png" />
<meta name="twitter:site" content="@seorenn" />
<meta name="twitter:creator" content="@seorenn" />
<link rel="stylesheet" type="text/css" href="/static/style.css"/>
<link rel="shortcut icon" type="image/x-icon" href="favicon.ico"/>
<link rel="canonical" href="https://seorenn.github.io/org-spreadsheet.html"/>
<link property="og:url" href="https://seorenn.github.io/org-spreadsheet.html"/>
<meta name="google-site-verification" content="YqTFZuthbvGIlDE1dhxiTjZ3m-GfyNs_rsHaOlPKpug" />
<meta name="naver-site-verification" content="ebf6a89968fd9f447c1a77d83e2c4aa9bdbb0345"/>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-44534026-1"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-44534026-1');
</script>
</head>
<body>
<script data-ad-client="ca-pub-1071465863344332" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<div id="content">
<header>
<h1 class="title">Org 스프레드시트</h1>
<h2><a href="/">Seorenn Static Pages</a></h2></header><nav id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgc8af239">소개</a></li>
<li><a href="#orgb7d172c">테이블</a></li>
<li><a href="#orgc157cb0">셀 정보 확인하기</a></li>
<li><a href="#org66003ca">Lisp 함수 실행시켜보기</a></li>
<li><a href="#org61bfab0">사칙연산 사용해보기</a></li>
<li><a href="#orgc07dc13">합계 구하기</a></li>
<li><a href="#orgbcca37c">계산 영역 제한하기</a></li>
<li><a href="#org2ede44e">calc 함수 목록</a></li>
<li><a href="#orgbcaddbb">관련글</a></li>
</ul>
</div>
</nav>

<div id="outline-container-orgc8af239" class="outline-2">
<h2 id="orgc8af239">소개</h2>
<div class="outline-text-2" id="text-orgc8af239">
<p>
<a href="org-mode.html">Org Mode</a> 의 테이블은 다양한 기능을 제공합니다. 그 중
하나가 테이블 셀을 이용해 계산을 하는 것입니다. 이 글은 이 기능에 관한
노트입니다.
</p>

<p>
참고로 이 글에서 언급하는 단축키는 <a href="doom-emacs.html">Doom Emacs</a> 기준입니다.
</p>
</div>
</div>
<div id="outline-container-orgb7d172c" class="outline-2">
<h2 id="orgb7d172c">테이블</h2>
<div class="outline-text-2" id="text-orgb7d172c">
<p>
일단 아래와 같은 테이블을 만들었다고 가정해봅시다.
</p>
<div class="org-src-container">
<pre class="src src-text">| Kind  | Price | Ideal | Earning |
|-------+-------+-------+---------|
| Book  |   100 |    99 |         |
| Apple |   256 |    30 |         |
| Coke  |     4 |     9 |         |
|-------+-------+-------+---------|
|       |       |       |         |
</pre>
</div>
<p>
영어 의미에 집착하지는 맙시다. 저도 어차피 콩글리쉬 유저입니다.
</p>

<p>
테이블을 작성하는 법은 <a href="org-mode.html">Org Mode</a> 글을 참고합시다.
</p>
</div>
</div>
<div id="outline-container-orgc157cb0" class="outline-2">
<h2 id="orgc157cb0">셀 정보 확인하기</h2>
<div class="outline-text-2" id="text-orgc157cb0">
<p>
우선 커서를 아래 <code>[]</code> 위치에 놨다고 생각합시다.
</p>
<div class="org-src-container">
<pre class="src src-text">| Kind  | Price | Ideal | Earning |
|-------+-------+-------+---------|
| Book  |   100 |    99 |      [] |
| Apple |   256 |    30 |         |
| Coke  |     4 |     9 |         |
|-------+-------+-------+---------|
|       |       |       |         |
</pre>
</div>
<p>
여기 위치를 파악하기 위해 <code>C-c ?</code> 혹은 <code>SPC m b h</code> 를 눌러봅시다. 그러면 하단
미니버퍼에 커서가 있는 위치의 주소를 알 수 있습니다.
</p>
<div class="org-src-container">
<pre class="src src-text">line @2, col $4, ref @2$4 or D2
</pre>
</div>
<p>
여기서 <code>@2$4</code> 라는 값이 커서가 위치한 셀의 위치를 한 번에 나타내는 문자입니다.
이 표현 방식을 잘 살펴봐 둡시다.
</p>

<p>
다른 정보도 확인해봅시다. <code>C-c }</code> 키를 누르면 테이블 헤더가 특정 정보가 토글됩니다.
</p>
<div class="org-src-container">
<pre class="src src-text">   1| Kind  | Price | Ideal | Earning |
I*1 |$1-----+$2-----+$3-----+$4-------|
   2| Book  |   100 |    99 |      [] |
   3| Apple |   256 |    30 |         |
   4| Coke  |     4 |     9 |         |
I*2 |$1-----+$2-----+$3-----+$4-------|
   5|       |       |       |         |
</pre>
</div>
<p>
이 정보를 통해서 <code>$1</code> 부터 <code>$4</code> 까지 표시되는 것이 컬럼(행, Column) 번호임을 유추할
수 있습니다. 그렇다면 남은 골뱅이는 로우(열, Row) 번호겠군요. 좌측의 숫자만 표시된
영역이 바로 로우 번호입니다.
참고로 이 정보는 같은 단축키를 한번 더 누르면 토글되서 없어집니다.
</p>
</div>
</div>
<div id="outline-container-org66003ca" class="outline-2">
<h2 id="org66003ca">Lisp 함수 실행시켜보기</h2>
<div class="outline-text-2" id="text-org66003ca">
<p>
이제 한가지 특수한 짓(?)을 해봅시다. 2번 로우의 2, 3번 컬럼의 값의 차이가
얼마인지를 구해서 그 오른쪽의 Earning 컬럼에 붙여봅시다.
커서가 위치한 곳인 <code>[]</code> 위치에 아래와 같은 것을 입력해봅시다.
</p>
<div class="org-src-container">
<pre class="src src-text">:='(- @2$3 $2$2);N
</pre>
</div>
<p>
위 텍스트를 입력하고 끝에서 <code>TAB</code> 키를 눌러주면 뭔가 변화가 생깁니다.
</p>
<div class="org-src-container">
<pre class="src src-text">| Kind  | Price | Ideal | Earning            |
|-------+-------+-------+--------------------|
| Book  |   100 |    99 | -1                 |
| Apple |   256 |    30 |                    |
| Coke  |     4 |     9 |                    |
|-------+-------+-------+--------------------|
|       |       |       |                    |
#+TBLFM: @2$4='(- @2$3 @2$2);N
</pre>
</div>
<p>
<code>-1</code> 이라는 값이 찍힌 것을 볼 수 있습니다. 3번 컬럼의 값($3)에서 2번 컬럼의
값($2)를 뺀 -1이라는 값이 찍힌 것입니다.
</p>

<p>
자 그럼 아까 입력했던 내용의 의미를 잠깐 이해해봅시다.
</p>
<ul class="org-ul">
<li><code>:=</code> 이 셀에는 이후에 나오는 내용으로 치환시킨다는 의미입니다.</li>
<li><code>'</code> <a href="lisp.html">Lisp</a> 의 quote 함수입니다. 잘 모르겠다면 현재 상황에서는
꼭 써야 한다고 생각하면 될 것 같습니다.</li>
<li><code>(- @2$3 @2$2)</code> 는 <a href="lisp.html">Lisp</a> 코드로 2열3행의 값에서 2열2행의 값을 뺀다는 의미입니다.</li>
<li><code>;N</code> Lisp 코드의 끝을 의미합니다.</li>
</ul>
<p>
이해가 되면 좋겠습니다.
</p>

<p>
이것 말고도 표의 하단에 아래와 같은 특수한 커맨드가 추가되어 있는 것이 보일 것입니다.
</p>
<div class="org-src-container">
<pre class="src src-text">#+TBLFM: @2$4='(- @2$3 @2$2);N
</pre>
</div>
<p>
<code>#+</code> 로 시작하는 표기는 <a href="org-mode.html">Org Mode</a>의 특수 커맨드라는 의미로
이해가됩니다. 아마도 방금 입력했던 식을 다르게 표시한 것으로 유추가 됩니다.
</p>

<p>
그렇다면 이 부분을 약간 고치면 몽땅 고칠 수 있을까요? TBLFM을 아래처럼
고쳐봅시다.
</p>
<div class="org-src-container">
<pre class="src src-text">#+TBLFM: $4='(- $3 $2);N
</pre>
</div>
<p>
수정한 뒤에는 <code>C-c C-c</code> 키를 눌러야 반영이 됩니다. 아마도 아래처럼 표시될 것입니다.
</p>
<div class="org-src-container">
<pre class="src src-text">| Kind  | Price | Ideal | Earning |
|-------+-------+-------+---------|
| Book  |   100 |    99 |      -1 |
| Apple |   256 |    30 |    -226 |
| Coke  |     4 |     9 |       5 |
|-------+-------+-------+---------|
|       |       |       |       0 |
#+TBLFM: $4='(- $3 $2);N
</pre>
</div>
<p>
4행의 값은 3행 빼기 2행의 값이다 라는 것을 정의해 버렸습니다. 이제 자동으로
입력된 값 외의 다른 값을 수정하면 제일 오른쪽 행의 값이 자동으로 바뀝니다.
그야말로 엑셀 같은 스프레드시트가 되었네요.
불행히도 마지막 열까지 바껴버린 것은 좀 안타깝지만요.
</p>

<p>
시작부터 <a href="lisp.html">Lisp</a> 코드를 사용해버린 것은 그냥 리습 코드도 쓸 수
있다는 예를 보여주고 싶었을 뿐입니다.
</p>
</div>
</div>
<div id="outline-container-org61bfab0" class="outline-2">
<h2 id="org61bfab0">사칙연산 사용해보기</h2>
<div class="outline-text-2" id="text-org61bfab0">
<p>
이제 <a href="lisp.html">Lisp</a> 코드 말고 <code>calc</code> 를 통해 제공되는
계산기 기능을 써 봅시다.
다시 테이블을 원래대로 리셋 시켰습니다.
</p>
<div class="org-src-container">
<pre class="src src-text">| Kind  | Price | Ideal | Earning |
|-------+-------+-------+---------|
| Book  |   100 |    99 |      [] |
| Apple |   256 |    30 |         |
| Coke  |     4 |     9 |         |
|-------+-------+-------+---------|
|       |       |       |         |
</pre>
</div>
<p>
커서 위치도 여전히 Earning 컬럼의 첫 로우에 있습니다. 여기서 이제 아래와 같은
커맨드를 입력해봅시다.
</p>
<div class="org-src-container">
<pre class="src src-text">=$3-$2
</pre>
</div>
<p>
이번엔 뭔가 아까랑 다르네요. <code>:=</code> 대신 그냥 <code>=</code> 으로 시작합니다.
어쨌든 입력을 하고 <code>TAB</code> 키를 누르는 순간
비슷하게 아래와 같이 표시됩니다.
</p>
<div class="org-src-container">
<pre class="src src-text">| Kind  | Price | Ideal | Earning |
|-------+-------+-------+---------|
| Book  |   100 |    99 |      -1 |
| Apple |   256 |    30 |         |
| Coke  |     4 |     9 |         |
|-------+-------+-------+---------|
|       |       |       |         |
#+TBLFM: $4=$3-$2
</pre>
</div>
<p>
이제 계산을 다시 하기 위해
<code>#+TBLFM</code> 쪽으로 커서를 가져한 후 <code>C-c C-c</code> 를 눌러봅시다.
</p>
<div class="org-src-container">
<pre class="src src-text">| Kind  | Price | Ideal | Earning |
|-------+-------+-------+---------|
| Book  |   100 |    99 |      -1 |
| Apple |   256 |    30 |    -226 |
| Coke  |     4 |     9 |       5 |
|-------+-------+-------+---------|
|       |       |       |       0 |
#+TBLFM: $4=$3-$2
</pre>
</div>
<p>
짠~ Earning 컬럼에 데이터가 자동으로 계산되어 들어갔습니다. 그렇다면 <code>:</code>
(콜론) 존재의 의미가 이해가 갈 것 같습니다.
<code>:=</code> 는 현재 셀에만 함수를 적용한다는 의미이고,
<code>=</code> 는 이 행이나 열 전체에 해당 함수를 적용한다는 의미일 것 같네요.
</p>

<p>
비록 가장 아래쪽에 이상한 데이터가 하나 들어가긴 했지만요.
</p>
</div>
</div>
<div id="outline-container-orgc07dc13" class="outline-2">
<h2 id="orgc07dc13">합계 구하기</h2>
<div class="outline-text-2" id="text-orgc07dc13">
<p>
이제 Price와 Ideal 수치 합계를 한번 계산해 봅시다.
제일 아래의 빈 로우에 값을 채워넣을 예정입니다.
여전히 커서는 <code>[]</code> 로 표시한 위치에 있다고 가정합시다.
</p>
<div class="org-src-container">
<pre class="src src-text">| Kind  | Price | Ideal | Earning |
|-------+-------+-------+---------|
| Book  |   100 |    99 |      -1 |
| Apple |   256 |    30 |    -226 |
| Coke  |     4 |     9 |       5 |
|-------+-------+-------+---------|
|       |    [] |       |       0 |
#+TBLFM: $4=$3-$2
</pre>
</div>
<p>
이번엔 조금 다른 방법을 써서 편집해 봅시다. <code>SPC m b e</code> 를 누르면 하단에 미니버퍼가
열리면서 여기에 입력할 값을 별도로 입력할 수 있습니다. 이 미니버퍼에 아래와 같은
커맨드를 입력해 봅시다.
</p>
<div class="org-src-container">
<pre class="src src-text">:=vsum(@2$2..@4$2)
</pre>
</div>
<p>
미니버퍼에 잘 표시가 되어있지만 위의 것을 입력한 후 <code>C-c C-c</code> 를 눌러야만
적용됩니다. 그러면 커서가 위치한 셀에 아까 입력한 내용이 입력됩니다. 사실
수동으로 그 위치에 입력하는 거랑 별 차이는 없으니 편한 방법을 쓰면 됩니다.
</p>

<p>
이제 할 일은 입력된 내용 위에서 <code>TAB</code> 키를 눌러보는 것입니다.
</p>
<div class="org-src-container">
<pre class="src src-text">| Kind  | Price | Ideal | Earning |
|-------+-------+-------+---------|
| Book  |   100 |    99 |      -1 |
| Apple |   256 |    30 |    -226 |
| Coke  |     4 |     9 |       5 |
|-------+-------+-------+---------|
|       |   360 |       |       0 |
#+TBLFM: $4=$3-$2::@5$2=vsum(@2$2..@4$2)
</pre>
</div>
<p>
짜잔. 이젠 아래에 Price 합계가 표시되었습니다. 그리고 제일 하단에 TBLFM 항목에도
방금 입력한 것과 비슷한 명령이 추가되어 있습니다. <code>::</code> 는 구분자인가 보네요.
</p>

<p>
입력했던 내용 자체는 앞서 살펴본 것과 비슷합니다.
<code>vsum</code> 함수는 지정된 범위 내의 데이터를
합하기 위한 <code>calc</code> 패키지의 함수입니다.
</p>

<p>
자 그렇다면 남은 빈 곳도 채우기 위해 직접 TBLFM 코드를 수정해 봅시다.
</p>
<div class="org-src-container">
<pre class="src src-text">#+TBLFM: $4=$3-$2::@5=vsum(@2..@4)
</pre>
</div>
<p>
고친 다음에 <code>C-c C-c</code> 를 입지 맙시다. 이렇게 하면 짜잔~
</p>
<div class="org-src-container">
<pre class="src src-text">| Kind                | Price | Ideal | Earning |
|---------------------+-------+-------+---------|
| Book                |   100 |    99 |      -1 |
| Apple               |   256 |    30 |    -226 |
| Coke                |     4 |     9 |       5 |
|---------------------+-------+-------+---------|
| Book + Apple + Coke |   360 |   138 |    -222 |
#+TBLFM: $4=$3-$2::@5=vsum(@2..@4)
</pre>
</div>
<p>
뭔가 다 채워지긴 했는데 이상하군요! 아하하🤦
</p>
</div>
</div>
<div id="outline-container-orgbcca37c" class="outline-2">
<h2 id="orgbcca37c">계산 영역 제한하기</h2>
<div class="outline-text-2" id="text-orgbcca37c">
<p>
위 결과에서 좌측 하단의 이상한(?) 것을 지워봅시다.
일단 제일 아래 로우 각 셀의 내용을 다 지운 다음
TBLFM의 가장 마지막 항목을 아래처럼 고쳐봤습니다.
</p>
<div class="org-src-container">
<pre class="src src-text">#+TBLFM: $4=$3-$2::@5$2..@5$4=vsum(@2..@4)
</pre>
</div>
<p>
그리고 TBLFM 위에서 <code>C-c C-c</code> 를 눌러보면 아래처럼 나옵니다.
</p>
<div class="org-src-container">
<pre class="src src-text">| Kind  | Price | Ideal | Earning |
|-------+-------+-------+---------|
| Book  |   100 |    99 |      -1 |
| Apple |   256 |    30 |    -226 |
| Coke  |     4 |     9 |       5 |
|-------+-------+-------+---------|
|       |   360 |   138 |    -222 |
#+TBLFM: $4=$3-$2::@5$2..@5$4=vsum(@2..@4)
</pre>
</div>
<p>
짜잔~ 원하던 데로 이상한 Book + Apple + Coke 라는 데이터가 사라졌습니다.
</p>

<p>
위에서 사용한 코드는 값이 들어가는 부분을 영역으로 표현했습니다.
<code>@5$2..@5$4</code> 까지만 vsum의 결과를 적용하겠다는 의미로 사용했지요.
이런 식으로도 할 수 있다는 것을 보여주고 싶었습니다.
</p>

<p>
비록 중복으로 뭔가 바뀌는 셀이 있다는 경고 메시지가 나오기는 하지만 뭐 원하는
대로 결과가 나왔으니 다 좋은 거겠지요 뭐&#x2026;
</p>
</div>
</div>
<div id="outline-container-org2ede44e" class="outline-2">
<h2 id="org2ede44e">calc 함수 목록</h2>
<div class="outline-text-2" id="text-org2ede44e">
<p>
일단 정보를 구한 것만 정리합니다. 더 많은 함수가 있을 수 있습니다.
</p>
<ul class="org-ul">
<li><code>exp(c)</code> 지수(exponential)</li>
<li><code>log(c)</code> log</li>
<li><code>log10(c)</code> log10</li>
<li><code>sqrt(c)</code> 루트(SQRT, Square-Root)</li>
<li><code>vcor(v1, v2)</code> 상관계수(correlation)</li>
<li><code>vcount(v)</code> 갯수</li>
<li><code>vcov(v1, v2)</code> 공분산(covariance)</li>
<li><code>vlen(v)</code> 길이(length)</li>
<li><code>vmax(v)</code> 최대값(maximum)</li>
<li><code>vmean(v)</code> 평균(average)</li>
<li><code>vmedian(v)</code> 중간값</li>
<li><code>vmin(v)</code> 최소값(minimum)</li>
<li><code>vprod(v)</code> 곱(product)</li>
<li><code>vsdev(v)</code> 표준편차(standard deviation)</li>
<li><code>vsum(v)</code> 합계</li>
<li><code>vvar(v)</code> 분산(variance)</li>
</ul>
</div>
</div>
<div id="outline-container-orgbcaddbb" class="outline-2">
<h2 id="orgbcaddbb">관련글</h2>
<div class="outline-text-2" id="text-orgbcaddbb">
<ul class="org-ul">
<li><a href="org-mode.html">Org Mode</a></li>
<li><a href="doom-emacs.html">Doom Emacs</a></li>
<li><a href="doom-emacs-shortcuts.html">Doom Emacs 단축키</a></li>
<li><a target="_blank" href="https://orgmode.org/worg/org-tutorials/org-spreadsheet-intro.html">🌏 Org as a spreadsheet system: a short introduction</a></li>
</ul>
</div>
</div>
<div id="footer"><div id="time">2020년 01월 06일 마지막으로 수정됨</div><div id="copyright">Copyright 2019 Heeseung Seo (Seorenn)</div></div></div>
</body>
</html>
