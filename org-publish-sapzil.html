<!DOCTYPE html>
<html lang="kr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>org-publish 삽질기 - Seorenn Static Pages</title>
<meta name="generator" content="Org mode">
<meta name="author" content="Heeseung Seo (Seorenn)">
<meta property="og:title" content="org-publish 삽질기" />
<meta property="og:type" content="website" />
<meta property="og:image" content="https://seorenn.github.io/img/seorenn-logo.png" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="org-publish 삽질기" />
<meta name="twitter:image" content="https://seorenn.github.io/img/seorenn-logo.png" />
<meta name="twitter:site" content="@seorenn" />
<meta name="twitter:creator" content="@seorenn" />
<link rel="stylesheet" type="text/css" href="/static/style.css"/>
<link rel="shortcut icon" type="image/x-icon" href="favicon.ico"/>
<link rel="canonical" href="https://seorenn.github.io/org-publish-sapzil.html"/>
<link property="og:url" href="https://seorenn.github.io/org-publish-sapzil.html"/>
<meta name="google-site-verification" content="YqTFZuthbvGIlDE1dhxiTjZ3m-GfyNs_rsHaOlPKpug" />
<meta name="naver-site-verification" content="ebf6a89968fd9f447c1a77d83e2c4aa9bdbb0345"/>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-44534026-1"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-44534026-1');
</script>
</head>
<body>
<script data-ad-client="ca-pub-1071465863344332" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<div id="content">
<header>
<h1 class="title">org-publish 삽질기</h1>
<h2><a href="/">Seorenn Static Pages</a></h2></header><p>
org-publish는 Emacs에서 org-mode로 작성된 .org 문서들로 정적 웹사이트를 만들 수 있게
해주는 도구입니다. 쉽게 말해서 특정 디렉토리 안의 .org 파일들을 .html 파일로
익스포트 해서 원하는 디렉토리로 복사해줍니다. 그리고 각종 css나 스크립트, 이미지
등의 파일도 자동으로 복사해 주기도 합니다.
</p>

<p>
이 글은 org-publish를 사용하기 위해 삽질했던 긴 시간의 기록을 짧게나마 정리해
보려는 글입니다.
</p>

<hr>

<div id="outline-container-orga9e6271" class="outline-2">
<h2 id="orga9e6271">서문</h2>
<div class="outline-text-2" id="text-orga9e6271">
<p>
나도 github pages를 이용해 블로그를 쓰고 싶다는 생각을 한 것이 꽤 많다. 물론
egloos, naver blog, blogger를 거쳐 현재의 tistory에 이르기까지 많은 블로깅
플래폼을 써오긴 했다. 하지만 플래폼마다 특유의 제한이 있다는 점은 좀 싫은
편이었다.
</p>

<p>
그러다 문득 든 생각이, 내가 주로 쓰는 글은 로그 형식과는 맞지 않는게 대부분이
아닌가 하는 생각이 들었다. 실제로 팁글이나 강좌 위주로 쓰다보니 시간 역순의
기록을 남기는 로그 스타일과는 어울리지 않기도 하다.
</p>

<p>
거기다 하나의 글을 완성하기 전에넌 퍼블리시를 하지 못 하는 상황도 좀 싫어졌다.
일부분이라도 조금씩 글을 쓰면서 완성해가는 모습을 보여주는게 더 좋을지도
모르겠지만 블로그는 이런 것과는 거리가 좀 먼 시스템이었다.
</p>
</div>
</div>
<div id="outline-container-orgb82ea4f" class="outline-2">
<h2 id="orgb82ea4f">첫 만남</h2>
<div class="outline-text-2" id="text-orgb82ea4f">
<p>
결국 github pages를 이용을 시도해보며 결정하기로 했다. 해보면 단점도 느껴지며
객관적인 비교가 가능해지리라는 생각에서다.
</p>

<p>
동시에 자주 사용하는 에디터인 Emacs에서
작성과 편찬을 자동으로 할 수 있다면 더 좋지 않을까 하는 생각이 들었다. Emacs에는
org-mode라는 뛰어난 아웃라이너 겸 플래너 겸 문서 작성 도구가 있었다. 글 쓰기에
딱 좋은 환경이라는 말이다.
</p>

<p>
그래서 Emacs로 org를 batch publish 할 수 있는 방법을 찾기 위해 org publish 라는
단어로 검색을 하다가 놀라운 것을 발견하게 된다. 바로 이름하야
<code>org-publish</code>! 딱 내가 원하는 기능을 모토로 만들어진 도구였다.
</p>

<p>
그래서 이 org-publish 삽질이 시작되게 되었다.
</p>
</div>
</div>
<div id="outline-container-orgc9d7355" class="outline-2">
<h2 id="orgc9d7355">시작</h2>
<div class="outline-text-2" id="text-orgc9d7355">
<p>
org-publish는 다행히도 별도로 설치할 필요가 없는 확장이다. Emacs에 빌트인
되어있기 때문이다. 단지 몇 가지 모듈은 자동으로 로딩되지 않기 때문에 수동으로
해야 했다.
</p>
<div class="org-src-container">
<pre class="src src-lisp">(<span style="color: #51afef;">require</span> '<span style="color: #a9a1e1;">ox-publish</span>)
(<span style="color: #51afef;">require</span> '<span style="color: #a9a1e1;">ox-html</span>)
(<span style="color: #51afef;">require</span> '<span style="color: #a9a1e1;">ox-rss</span>)
</pre>
</div>
<p>
사실 마지막 <code>ox-rss</code> 모듈은 RSS를 만들기 위한 것이 아니면 필요가 없는데 나중에
필요할지도 몰라서 일단 넣어놨다.
</p>

<p>
물론 이걸로는 아무것도 못 한다. 이제 거대한 설정 스크립트를 작성해야 한다.
</p>
</div>
</div>
<div id="outline-container-org3a5ab55" class="outline-2">
<h2 id="org3a5ab55">기본 설정</h2>
<div class="outline-text-2" id="text-org3a5ab55">
<p>
<code>org-publish-project-alist</code> 라는 리스트가 org-publish의 핵심이다. 여기에서
모든것이 출발한다.
</p>

<p>
이 리스트의 내용을 설명하기 전에 우선 디렉토리 구성에 대해 가정하고 넘어가자.
일단 아래와 같은 디렉토리에서 글을 쓴다고 가정하자.
</p>
<div class="org-src-container">
<pre class="src src-text">~/org/
    static/
        style.css
    img/
        someimage.jpg
    index.org
    foobar.org
    ...
</pre>
</div>
<p>
<code>~/org</code> 라는 디렉토리에서 .org 파일로 글을 작성한다. 그리고 <code>~/org/static</code> 에는
스타일 파일과 미래에 사용할지도 모를 자바스크립트 파일 등을 넣을 예정이다.
<code>~/org/img</code> 디렉토리는 이름처럼 이미지만 넣을 에정이다.
</p>

<p>
이 상태로 글을 쓰다 github pages로 올리기 위해서는 아래의 디렉토리에 html로
만들어진 결과물이 들어가게 만들어야 한다고 가정하자.
</p>
<div class="org-src-container">
<pre class="src src-text">~/web/
    static/
        style.css
    img/
        someimage.jpg
    index.html
    foobar.html
    ...
</pre>
</div>
<p>
그냥 .org 파일이 .html로 바뀐거 빼곤 이름과 배치가 동일하다.
</p>

<p>
이런 식으로 변경하기 위해서 org-publish를 설정해보자. 아래와 같은 설정을 만들면
된다.
</p>
<div class="org-src-container">
<pre class="src src-lisp">(setq org-publish-project-alist
      '((<span style="color: #98be65;">"doc"</span>
         <span style="color: #c678dd;">:base-directory</span> <span style="color: #98be65;">"~/org"</span>
         <span style="color: #c678dd;">:base-extension</span> <span style="color: #98be65;">"org"</span>

         <span style="color: #c678dd;">:publishing-directory</span> <span style="color: #98be65;">"~/web/"</span>

         <span style="color: #c678dd;">:recursive</span> t

         <span style="color: #c678dd;">:with-toc</span> nil
         <span style="color: #c678dd;">:with-title</span> t
         <span style="color: #c678dd;">:with-date</span> t
         <span style="color: #c678dd;">:section-numbers</span> nil
         <span style="color: #c678dd;">:html-doctype</span> <span style="color: #98be65;">"html5"</span>
         <span style="color: #c678dd;">:html-html5-fancy</span> t
         <span style="color: #c678dd;">:html-head-include-default-style</span> nil
         <span style="color: #c678dd;">:html-head-include-scripts</span> nil
         <span style="color: #c678dd;">:htmlized-source</span> t
         )
        (<span style="color: #98be65;">"static"</span>
         <span style="color: #c678dd;">:base-directory</span> <span style="color: #98be65;">"~/org/static"</span>
         <span style="color: #c678dd;">:base-extension</span> <span style="color: #98be65;">"css\\|js\\|png\\|jpg\\|jpeg\\|gif"</span>
         <span style="color: #c678dd;">:publishing-directory</span> <span style="color: #98be65;">"~/web/static"</span>
         <span style="color: #c678dd;">:recursive</span> t
         <span style="color: #c678dd;">:publishing-function</span> org-publish-attachment)
        (<span style="color: #98be65;">"img"</span>
         <span style="color: #c678dd;">:base-directory</span> <span style="color: #98be65;">"~/org/img"</span>
         <span style="color: #c678dd;">:base-extension</span> <span style="color: #98be65;">"png\\|jpg\\|jpeg\\|gif"</span>
         <span style="color: #c678dd;">:publishing-directory</span> <span style="color: #98be65;">"~/web/img"</span>
         <span style="color: #c678dd;">:recursive</span> t
         <span style="color: #c678dd;">:publishing-function</span> org-publish-attachment)
        (<span style="color: #98be65;">"web"</span> <span style="color: #c678dd;">:components</span> (<span style="color: #98be65;">"doc"</span> <span style="color: #98be65;">"static"</span> <span style="color: #98be65;">"img"</span>))))
</pre>
</div>
</div>
</div>
<div id="outline-container-orgaf6d6b1" class="outline-2">
<h2 id="orgaf6d6b1">Publish 해보기</h2>
<div class="outline-text-2" id="text-orgaf6d6b1">
<p>
아마도 별도의 단축키는 셋업되지 않았을 것 같으니 그냥 <code>org-publish-all</code> 함수를 쓰는게 속 편할지도
모르겠다. 대충 <code>M-x org-publish-all</code> 로 실행시키거나, 혹은 Doom Emacs 라면
<code>SPC : org-publish-all</code> 로 실행시키면 된다.
</p>

<p>
별 문제가 없다면 이 명령 만으로 목적대로 원하는 디렉토리에 html과 함께 정적
파일들도 복사될 것이다. github page에 올리는 것이니 마무리로 git으로 commit과
push만 하면 사이트에 올릴 수도 있다.
</p>

<p>
(업데이트 중)
</p>

<hr>

<p>
관련글: <a href="./doom-emacs.html">Doom Emacs</a>
</p>
</div>
</div>
<div id="footer"><div id="time">2019년 12월 14일 마지막으로 수정됨</div><div id="copyright">Copyright 2019 Heeseung Seo (Seorenn)</div></div></div>
</body>
</html>
