<!DOCTYPE html>
<html lang="kr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>SwiftUI + Combine - Seorenn Static Pages</title>
<meta name="generator" content="Org mode">
<meta name="author" content="Heeseung Seo (Seorenn)">
<meta name="description" content="SwiftUI에서 Combine Framework를 어떻게 사용하고 있는지 간단히 정리한 글입니다.">
<meta name="keywords" content="swift, swiftui, combine, framework, reactive, rx">
<meta property="og:title" content="SwiftUI + Combine" />
<meta property="og:description" content="SwiftUI에서 Combine Framework를 어떻게 사용하고 있는지 간단히 정리한 글입니다." />
<meta property="og:type" content="website" />
<meta property="og:image" content="https://seorenn.github.io/img/seorenn-logo.png" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="SwiftUI + Combine" />
<meta name="twitter:description" content="SwiftUI에서 Combine Framework를 어떻게 사용하고 있는지 간단히 정리한 글입니다." />
<meta name="twitter:image" content="https://seorenn.github.io/img/seorenn-logo.png" />
<meta name="twitter:site" content="@seorenn" />
<meta name="twitter:creator" content="@seorenn" />
<link rel="stylesheet" type="text/css" href="/static/style.css"/>
<link rel="shortcut icon" type="image/x-icon" href="favicon.ico"/>
<link rel="canonical" href="https://seorenn.github.io/swiftui-combine.html"/>
<link property="og:url" href="https://seorenn.github.io/swiftui-combine.html"/>
<meta name="google-site-verification" content="YqTFZuthbvGIlDE1dhxiTjZ3m-GfyNs_rsHaOlPKpug" />
<meta name="naver-site-verification" content="ebf6a89968fd9f447c1a77d83e2c4aa9bdbb0345"/>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-44534026-1"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-44534026-1');
</script>
</head>
<body>
<script data-ad-client="ca-pub-1071465863344332" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<div id="content">
<header>
<h1 class="title">SwiftUI + Combine</h1>
<h2><a href="/">Seorenn Static Pages</a></h2></header>
<div id="outline-container-org5209041" class="outline-2">
<h2 id="org5209041">SwiftUI + Combine</h2>
<div class="outline-text-2" id="text-org5209041">
<p>
이 글은 SwiftUI로 UI를 코딩할 때 사용하게 되는
<a href="combine-framework.html">Combine Framework</a> 기능을 다룹니다. 아마도
Property Wrapper로 구현된 것들 위주로 메모될 가능성이 큽니다.
</p>
</div>
</div>
<div id="outline-container-orgeccfa83" class="outline-2">
<h2 id="orgeccfa83">State</h2>
<div class="outline-text-2" id="text-orgeccfa83">
<p>
<code>@State</code> 는 뷰(View)가 해당 프로퍼티의 값 변화를 모니터링 할 수 있도록 해 줍니다.
</p>
<div class="org-src-container">
<pre class="src src-swift"><span style="color: #51afef;">struct</span> <span style="color: #c678dd;">ContentView</span>: View {
    <span style="color: #51afef;">@State</span> <span style="color: #51afef;">private</span> <span style="color: #51afef;">var</span> name = <span style="color: #98be65;">"World"</span>

    <span style="color: #51afef;">var</span> body: <span style="color: #51afef;">some</span> View {
        VStack {
            <span style="color: #c678dd;">Text</span>(<span style="color: #98be65;">"Hello, \(</span>name<span style="color: #98be65;">)!"</span>)
                .<span style="color: #c678dd;">padding</span>()
            <span style="color: #c678dd;">Button</span>(
                action: { <span style="color: #51afef;">self</span>.<span style="color: #c678dd;">switchName</span>() },
                label: { <span style="color: #c678dd;">Text</span>(<span style="color: #98be65;">"Switch"</span>) }
            )
        }
    }

    <span style="color: #51afef;">func</span> <span style="color: #c678dd;">switchName</span>() {
        <span style="color: #51afef;">if</span> name == <span style="color: #98be65;">"World"</span> {
            name = <span style="color: #98be65;">"Universe"</span>
        } <span style="color: #51afef;">else</span> {
            name = <span style="color: #98be65;">"World"</span>
        }
    }
}
</pre>
</div>
<p>
위 예제는 버튼을 누를 때 마다 <code>name</code> 프로퍼티의 값을 바꾸는데 이에 따라 뷰도
자동으로 내용이 업데이트 되는 것을 확인할 수 있습니다.
</p>

<p>
<code>@State</code> 는 해당 뷰의 바디 내에서만 액세스 가능합니다. 따라서 <code>@State</code> 로 적용할
프로퍼티는 가급적 <code>private</code> 로 선언하는 것이 좋습니다.
</p>
</div>
</div>
<div id="outline-container-orgf33eba1" class="outline-2">
<h2 id="orgf33eba1">ObservedObject</h2>
<div class="outline-text-2" id="text-orgf33eba1">
<p>
<code>@ObservedObject</code> 는 <code>@State</code> 와 비슷하지만 기본 타입이 아닌 여러 프로퍼티나
메소드 등으로 구현된 커스텀 클래스 타입일 경우에 유용하게 사용할 수 있습니다.
</p>
<div class="org-src-container">
<pre class="src src-swift"><span style="color: #51afef;">class</span> <span style="color: #c678dd;">MyData</span>: ObservableObject {
    <span style="color: #51afef;">@Published</span> <span style="color: #51afef;">var</span> name = <span style="color: #98be65;">"World"</span>
    <span style="color: #51afef;">@Published</span> <span style="color: #51afef;">var</span> buttonTitle = <span style="color: #98be65;">"Switch to Universe"</span>

    <span style="color: #51afef;">func</span> <span style="color: #c678dd;">switchName</span>() {
        <span style="color: #51afef;">if</span> name == <span style="color: #98be65;">"World"</span> {
            name = <span style="color: #98be65;">"Universe"</span>
            buttonTitle = <span style="color: #98be65;">"Switch to World"</span>
        } <span style="color: #51afef;">else</span> {
            name = <span style="color: #98be65;">"World"</span>
            buttonTitle = <span style="color: #98be65;">"Switch to Universe"</span>
        }
    }
}

<span style="color: #51afef;">struct</span> <span style="color: #c678dd;">ContentView</span>: View {
    <span style="color: #51afef;">@ObservedObject</span> <span style="color: #51afef;">var</span> data = <span style="color: #c678dd;">MyData</span>()

    <span style="color: #51afef;">var</span> body: <span style="color: #51afef;">some</span> View {
        VStack {
            <span style="color: #c678dd;">Text</span>(<span style="color: #98be65;">"Hello, \(</span>data.<span style="color: #c678dd;">name</span><span style="color: #98be65;">)!"</span>)
                .<span style="color: #c678dd;">padding</span>()
            <span style="color: #c678dd;">Button</span>(
                action: { <span style="color: #51afef;">self</span>.<span style="color: #c678dd;">data</span>.<span style="color: #c678dd;">switchName</span>() },
                label: { <span style="color: #c678dd;">Text</span>(<span style="color: #51afef;">self</span>.<span style="color: #c678dd;">data</span>.<span style="color: #dcaeea;">buttonTitle</span>) }
            )
        }
    }
}
</pre>
</div>
<p>
<code>@ObservedObject</code> 가 되기 위해서는 반드시 <code>ObservableObject</code> 프로토콜을 따르는
클래스여야 합니다. 또한 각 프로퍼티 값이 바뀌었을 때 제대로 업데이트가
된 것을 모니터링 하려면 해당 프로퍼티에는 <code>@Published</code> 를 붙여야 합니다.
</p>

<p>
이름처럼 반드시 클래스여야 하기 때문에 오브젝트 공유가 가능해진다는 장점이 있다는 것을 기억합니다.
</p>
</div>
</div>
<div id="outline-container-orgfbda86b" class="outline-2">
<h2 id="orgfbda86b">EnvironmentObject</h2>
<div class="outline-text-2" id="text-orgfbda86b">
<p>
<code>@EnvironmentObject</code> 는 <code>@ObservedObject</code> 와 비슷하게 쓸 수 있지만, 다른
특징으로 공유 환경을 만들어 준다는 점이 있습니다.
</p>
<div class="org-src-container">
<pre class="src src-swift"><span style="color: #51afef;">class</span> <span style="color: #c678dd;">SharedData</span>: ObservableObject {
    <span style="color: #51afef;">@Published</span> <span style="color: #51afef;">var</span> configName = <span style="color: #98be65;">"default"</span>
    ...
}

<span style="color: #51afef;">struct</span> <span style="color: #c678dd;">ContentView</span>: View {
    <span style="color: #51afef;">@EnvironmentObject</span> <span style="color: #51afef;">var</span> sharedData: SharedData
    ...
}

<span style="color: #51afef;">struct</span> <span style="color: #c678dd;">FooView</span>: View {
    <span style="color: #51afef;">@EnvironmentObject</span> <span style="color: #51afef;">var</span> sharedData: SharedData
    ...
}
</pre>
</div>
<p>
코드 의미를 보면 <code>sharedData</code> 는 <code>ContentView</code> 와 <code>FooView</code> 에서 공유하려는
오브젝트임을 알 수 있습니다. 여기서 한 가지만 더 추가되면 양쪽의 <code>sharedData</code>
프로퍼티는 싱글턴 오브젝트처럼 공유할 수 있게 됩니다.
</p>

<p>
Xcode에서 SwiftUI 프로젝트를 생성했다면 <code>SceneDelegate.swift</code> 라는 파일이 생성되어
있을 것입니다. 여기에 보면 <code>UIHostingController</code> 를 생성할 때 <code>ContentView</code> (최초의 뷰) 인스턴스를
넣어주는 부분이 있습니다. 여기를 약간 고치면 됩니다.
</p>
<div class="org-src-container">
<pre class="src src-swift"><span style="color: #51afef;">var</span> sharedData = <span style="color: #c678dd;">SharedData</span>()
...
window.<span style="color: #dcaeea;">rootViewController</span> =
    <span style="color: #c678dd;">UIHostingController</span>(rootView: <span style="color: #c678dd;">ContentView</span>()
                                      .<span style="color: #c678dd;">environmentObject</span>(sharedData))
</pre>
</div>
<p>
이렇게 하면 위에서 생성된 <code>sharedData</code> 는 공유 오브젝트가 되어서
모든 뷰에서 공유할 수 있게 됩니다.
물론 <code>@ObservedObject</code> 의 특징도 같이 사용할 수 있습니다.
</p>
</div>
</div>
<div id="outline-container-orgaae42c6" class="outline-2">
<h2 id="orgaae42c6">달러 연산자?</h2>
<div class="outline-text-2" id="text-orgaae42c6">
<p>
상호작용이 가능한 컴포넌트의 경우 UI의 값이 바뀌면 데이터의 값도 자동으로
바뀌어야 합니다. MVVM의 ViewModel이 이러한 방식의 개념이지요. 어쨌든 이럴때
사용하는 것이 바로 <code>$</code> 입니다.
</p>
<div class="org-src-container">
<pre class="src src-swift"><span style="color: #51afef;">struct</span> <span style="color: #c678dd;">ContentView</span>: View {
    <span style="color: #51afef;">@State</span> <span style="color: #51afef;">var</span> show = <span style="color: #a9a1e1;">false</span>

    <span style="color: #51afef;">var</span> body: someView {
        <span style="color: #c678dd;">Toggle</span>(isOn: $show) {
            <span style="color: #c678dd;">print</span>(<span style="color: #98be65;">"Toggle Title"</span>)
        }
    }
}
</pre>
</div>
<p>
당연히 <code>@State</code> 뿐만 아니라 <code>@ObservedObject</code> 는 물론 <code>@EnvironmentObject</code>
에서도 사용할 수 있는 오퍼레이터입니다.
</p>
</div>
</div>
<div id="outline-container-org14d7c16" class="outline-2">
<h2 id="org14d7c16">관련글</h2>
<div class="outline-text-2" id="text-org14d7c16">
<ul class="org-ul">
<li><a href="swift.html">Swift</a></li>
<li><a href="swiftui.html">SwiftUI</a></li>
<li><a href="combine-framework.html">Combine Framework</a></li>
</ul>
</div>
</div>
<div id="footer"><div id="time">2020년 01월 06일 마지막으로 수정됨</div><div id="copyright">Copyright 2019 Heeseung Seo (Seorenn)</div></div></div>
</body>
</html>
