<html lang="ko">
<head>
<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link rel="stylesheet" href="/static/style.css" />
<title>Docker - Seorenn</title>
<meta name="twitter:title" content="Docker" />
<meta name="og:title" content="Docker" />
<meta name="description" content="컨테이너 기반 가상화 플랫폼인 도커(Docker)의 간단한 소개 및 몇 가지 팁과 함께 관련 글들을 정리합니다." />
<meta name="twitter:description" content="컨테이너 기반 가상화 플랫폼인 도커(Docker)의 간단한 소개 및 몇 가지 팁과 함께 관련 글들을 정리합니다." />
<meta name="og:description" content="컨테이너 기반 가상화 플랫폼인 도커(Docker)의 간단한 소개 및 몇 가지 팁과 함께 관련 글들을 정리합니다." />
<link rel="canonical" href="https://seorenn.github.io/note/docker.html" />
<meta property="og:url" content="https://seorenn.github.io/note/docker.html" />
<link rel="alternate" type="application/rss+xml" title="Seorenn Note Feeds" href="/rss.xml"/>
<link rel="shortcut icon" type="image/x-icon" href="/static/favicon.ico" />
<meta name="twitter:image"content="https://seorenn.github.io/static/seorenn-symbol.png" />
<meta property="og:image" content="https://seorenn.github.io/static/seorenn-symbol.png" />
<meta property="og:image:width" content="520" />
<meta property="og:image:height" content="329" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:site" content="@seorenn" />
<meta name="twitter:creator" content="@seorenn" />
<meta property="og:type" content="article" />
<meta property="og:site_name" content="Seorenn Note" />
<meta property="og:locale" content="ko_KR" />
<meta name="referrer" content="unsafe-url" />
<meta name="robots" content="follow,index" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<meta name="google-site-verification" content="YqTFZuthbvGIlDE1dhxiTjZ3m-GfyNs_rsHaOlPKpug" />
<meta name="naver-site-verification" content="ebf6a89968fd9f447c1a77d83e2c4aa9bdbb0345" />
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-44534026-1"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-44534026-1');
</script>
<script data-ad-client="ca-pub-1071465863344332" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
</head>
<body>
<header class="top-header">
<div class="logo-container">
<a href="/" title="Seorenn"><img class="site-logo" src="/static/seorenn-logo.png" /></a>
<nav>
<a href="/" title="Home"><img src="/static/icon-home.svg" alt="home" class="menu-icon" /></a>
<a href="/post" title="Post"><img src="/static/icon-post.svg" alt="post" class="menu-icon" /></a>
 <a href="/note" title="Note"><img src="/static/icon-note.svg" alt="note" class="menu-icon" /></a>
</nav>
</div>
</header>
<div class="top-ad">
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1071465863344332"
     data-ad-slot="4306465772"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<section class="content">
<header>
<h1>Docker</h1>
<div class="title-date">2020년 4월 15일 수정</div>
</header>
<div id="table-of-contents">
<h2>≡ 목차 (Table of Contents)</h2><div id="text-table-of-contents">
<ul>
<li><a href="#org0515407">용어</a>
<ul>
<li><a href="#org9b94fa2">이미지(image)</a></li>
<li><a href="#org3055e3e">컨테이너(container)</a></li>
</ul>
</li>
<li><a href="#org613302e">자주 사용하는 커맨드들</a>
<ul>
<li><a href="#org6c2667a">images</a></li>
<li><a href="#orgab2424f">pull</a></li>
<li><a href="#orgae14780">build</a></li>
<li><a href="#org6891300">run</a></li>
<li><a href="#org215faff">exec</a></li>
<li><a href="#org68ea9ac">logs</a></li>
<li><a href="#org4496eb9">ps</a></li>
<li><a href="#org6e443e0">stop</a></li>
<li><a href="#orge416b9f">kill</a></li>
<li><a href="#org9be5f93">rm</a></li>
<li><a href="#org947318f">network</a></li>
</ul>
</li>
<li><a href="#org49702b7">사용법 예제들</a></li>
<li><a href="#orgf933a19">멀티 컨테이너 커스텀 네트워크</a></li>
<li><a href="#orgec75188">기타 사용법</a>
<ul>
<li><a href="#org5c0d70b">모든 컨테이너 중지</a></li>
<li><a href="#orgc7571cc">모든 컨테이너 삭제</a></li>
</ul>
</li>
<li><a href="#org582c066">활용 예제</a>
<ul>
<li><a href="#orga1a598f">구 버전 MongoDB CLI 가 필요할 때</a></li>
</ul>
</li>
<li><a href="#org67f00d3">공간 비우기</a></li>
<li><a href="#org4d443c1">기타 메모</a>
<ul>
<li><a href="#orga16eeb6">컨테이너에서 호스트 포트에 접근하기(macOS)</a></li>
<li><a href="#org4210348">적당히 시작하기 좋은 이미지들</a></li>
</ul>
</li>
<li><a href="#org0f83cc0">관련된 글들</a></li>
</ul>
</div>
</div>
<p>
도커는 정석적인 설명으론 컨테이너 기반 가상화 플랫폼이라고 소개하곤 한다.
물론 이 말 만으론 뭔 소리인지 감이 안 온다.
개인적으론 그저 가상으로 OS 수준까지
샌드박스를 만들어 주는 것처럼 보이지만
실제로 프로세스 격리라는 더 특이한 기능을 제공한다고 볼 수 있다.
</p>

<p>
개인적으로 개발단계나 서비스 단계에서 자주 사용하지만, 특정 유틸리티나 서비스를
사용하기 위해서도 종종 사용한다.
</p>

<div id="outline-container-org0515407" class="outline-2">
<h2 id="org0515407">용어</h2>
<div class="outline-text-2" id="text-org0515407">
</div>
<div id="outline-container-org9b94fa2" class="outline-3">
<h3 id="org9b94fa2">이미지(image)</h3>
<div class="outline-text-3" id="text-org9b94fa2">
<p>
도커에서 실제로 실행시킬 프로그램이나 환경을 특정한 방식으로 만들어 놓은 것을 의미한다.
</p>
</div>
</div>
<div id="outline-container-org3055e3e" class="outline-3">
<h3 id="org3055e3e">컨테이너(container)</h3>
<div class="outline-text-3" id="text-org3055e3e">
<p>
이미지를 실제로 실행시킨 인스턴스를 컨테이너라고 부른다.
</p>
</div>
</div>
</div>
<div id="outline-container-org613302e" class="outline-2">
<h2 id="org613302e">자주 사용하는 커맨드들</h2>
<div class="outline-text-2" id="text-org613302e">
<p>
개인적으로 자주 사용하는 일부 커맨드만 정리합니다.
</p>
</div>
<div id="outline-container-org6c2667a" class="outline-3">
<h3 id="org6c2667a">images</h3>
<div class="outline-text-3" id="text-org6c2667a">
<p>
이미지 리스트를 볼 수 있다.
</p>
</div>
</div>
<div id="outline-container-orgab2424f" class="outline-3">
<h3 id="orgab2424f">pull</h3>
<div class="outline-text-3" id="text-orgab2424f">
<p>
이미지를 다운로드 받는다.
하지만 <code>run</code> 으로 실행시키면 없는 이미지를 자동으로 다운로드 받기 때문에
그다지 쓸 일이 없는 커맨드다.
</p>
</div>
</div>
<div id="outline-container-orgae14780" class="outline-3">
<h3 id="orgae14780">build</h3>
<div class="outline-text-3" id="text-orgae14780">
<p>
이미지를 명세 파일에 써 있는 대로 빌드한다.
기본 명세 파일 이름은 <code>Dockerfile</code> 이다.
</p>
<dl class="org-dl">
<dt><code>-f</code></dt><dd><code>Dockerfile</code> 대신 다른 이름이나 경로를 지정해 줄 수 있다.</dd>
<dt><code>-t</code></dt><dd>이미지 이름이나 버전 태그 등을 지정할 수 있다.</dd>
</dl>
</div>
</div>
<div id="outline-container-org6891300" class="outline-3">
<h3 id="org6891300">run</h3>
<div class="outline-text-3" id="text-org6891300">
<p>
이미지를 실행시킨다. 즉 컨테이너를 띄운다&#x2026;.
</p>
<dl class="org-dl">
<dt><code>-d</code></dt><dd>데몬(백그라운드 프로세스) 모드로 실행</dd>
<dt><code>-it</code></dt><dd>커맨드를 인터랙티브로 실행</dd>
<dt><code>--rm</code></dt><dd>컨테이너가 종료되면 자동으로 컨테이너 삭제</dd>
<dt><code>-p HOST:CONTAINER</code></dt><dd>호스트 포트와 컨테이너 내부 포트를 연결</dd>
<dt><code>-v HOST_CONTAINER</code></dt><dd>호스트 파일 시스템과 컨테이너 내부 파일 시스템을 연결</dd>
<dt><code>-e NAME=VALUE</code></dt><dd>환경변수를 전달</dd>
<dt><code>--name NAME</code></dt><dd>컨테이너 이름</dd>
<dt><code>--net NETWORK</code></dt><dd>네트워크 이름</dd>
</dl>
</div>
</div>
<div id="outline-container-org215faff" class="outline-3">
<h3 id="org215faff">exec</h3>
<div class="outline-text-3" id="text-org215faff">
<p>
실행 중인 컨테이너에 특정 커맨드를 전달한다.
</p>
<dl class="org-dl">
<dt><code>-it</code></dt><dd>인터랙티브 커맨드를 전달한다.
즉 실행 중인 컨테이너에서 <a href="shell.html">셸</a> 등을 띄울 때 요긴하게 사용된다.</dd>
</dl>
</div>
</div>
<div id="outline-container-org68ea9ac" class="outline-3">
<h3 id="org68ea9ac">logs</h3>
<div class="outline-text-3" id="text-org68ea9ac">
<p>
컨테이너의 로그를 본다.
</p>
<dl class="org-dl">
<dt><code>-f</code></dt><dd>지속적으로 로그를 살펴볼 수도 있는데 마치 <code>tail -f</code> 의 옵션과 비슷하다.</dd>
</dl>
</div>
</div>
<div id="outline-container-org4496eb9" class="outline-3">
<h3 id="org4496eb9">ps</h3>
<div class="outline-text-3" id="text-org4496eb9">
<p>
실행 중인 컨테이너 리스트를 살펴본다.
</p>
<dl class="org-dl">
<dt><code>-a</code></dt><dd>옵션은 실행 중이던 아니던 모든 컨테이너 리스트를 조회</dd>
<dt><code>-q</code></dt><dd>옵션은 컨테이너 고유 번호 만을 출력한다. 다른 커맨드에 인자로 넘겨야 할
때 유용하다.</dd>
</dl>
</div>
</div>
<div id="outline-container-org6e443e0" class="outline-3">
<h3 id="org6e443e0">stop</h3>
<div class="outline-text-3" id="text-org6e443e0">
<p>
특정 컨테이너들을 종료한다.
</p>
</div>
</div>
<div id="outline-container-orge416b9f" class="outline-3">
<h3 id="orge416b9f">kill</h3>
<div class="outline-text-3" id="text-orge416b9f">
<p>
특정 컨테이너들을 강제로 종료한다.
</p>
</div>
</div>
<div id="outline-container-org9be5f93" class="outline-3">
<h3 id="org9be5f93">rm</h3>
<div class="outline-text-3" id="text-org9be5f93">
<p>
특정 컨테이너들을 삭제한다.
</p>
</div>
</div>
<div id="outline-container-org947318f" class="outline-3">
<h3 id="org947318f">network</h3>
<div class="outline-text-3" id="text-org947318f">
<p>
도커 네트워크를 다루는 하위 명령을 사용한다.
</p>
<dl class="org-dl">
<dt><code>ls</code></dt><dd>네트워크 리스트를 출력</dd>
<dt><code>create NAME</code></dt><dd>네트워크를 생성</dd>
<dt><code>rm NAME</code></dt><dd>네트워크 삭제</dd>
<dt><code>prune</code></dt><dd>기본 네트워크를 제외한 모든 네트워크를 삭제</dd>
</dl>
</div>
</div>
</div>
<div id="outline-container-org49702b7" class="outline-2">
<h2 id="org49702b7">사용법 예제들</h2>
<div class="outline-text-2" id="text-org49702b7">
<dl class="org-dl">
<dt><code>docker images</code></dt><dd>이미지 리스트 보기</dd>
<dt><code>docker pull IMAGE_NAME</code></dt><dd>이미지 다운로드 받기</dd>
<dt><code>docker build .</code></dt><dd>현재 디렉터리에 있는 Dockerfile 명세로 빌드하기</dd>
<dt><code>docker build -t IMAGE_NAME .</code></dt><dd>이미지를 특정 이름으로 빌드하기</dd>
<dt><code>docker build -t IMAGE_NAME:TAG_NAME .</code></dt><dd>태그까지 붙여서 이미지
빌드하기(태그는 옵션)</dd>
<dt><code>docker -f /foo/bar/some-dockerfile build -t IMAGE_NAME:TAG_NAME .</code></dt><dd>Dockerfile이 다른 경로에 있거나 혹은
Dockerfile 대신 다른 파일 이름을 사용한다면 이런 식으로 -f 옵션을 쓸 수 있다.</dd>
<dt><code>docker run IMAGE_NAME</code></dt><dd>특정 이미지 컨테이너 띄우기</dd>
<dt><code>docker run IMAGE_NAME:TAG_NAME</code></dt><dd>특정 태그(버전)의 이미지를 띄우기</dd>
<dt><code>docker run -d IMAGE_NAME</code></dt><dd>데몬(백그라운드) 모드로 실행하기</dd>
<dt><code>docker run -d -e ENV=VALUE IMAGE_NAME</code></dt><dd>특정 환경변수를 전달하며 데몬(백그라운드) 모드로 실행하기</dd>
<dt><code>docker run --rm -it IMAGE_NAME COMMAND</code></dt><dd>종료하면 사라지는(&#x2013;rm) 컨테이너로
터미널(-it) 커맨드 실행하기</dd>
<dt><code>docker run -p HOST_PORT:CONTAINER_PORT COMMAND</code></dt><dd>호스트 포트와 컨테이너 포트를
연결해서 컨테이너를 띄워서 커맨드 실행하기</dd>
<dt><code>docker run -v HOST_PATH:CONTAINER_PATH COMMAND</code></dt><dd>호스트 디렉토리와 컨테이너
디렉토리를 볼륨으로 연결해서 컨테이너를 띄워 커맨드 실행하기(호스트와 데이터
공유 시)</dd>
<dt><code>docker ps</code></dt><dd>살아있는(?) 컨테이너 리스트 보기</dd>
<dt><code>docker ps -a</code></dt><dd>모든 컨테이너 리스트 보기</dd>
<dt><code>docker exec -it CONTAINER_ID COMMAND</code></dt><dd>특정 동작 중인 컨테이너에서 커맨드 실행하기</dd>
<dt><code>docker logs CONTAINER_ID</code></dt><dd>로그 보기</dd>
<dt><code>docker logs CONTAINER_ID --tail 10</code></dt><dd>로그 마지막 끝 10줄만 보기</dd>
<dt><code>docker logs -f CONTAINER_ID</code></dt><dd>로그 갱신 계속 모니터링 하기</dd>
<dt><code>docker stop CONTINER_ID</code></dt><dd>컨테이너 중지</dd>
<dt><code>docker rm CONTAINER_ID</code></dt><dd>컨테이너 삭제</dd>
<dt><code>docker rmi IMAGE_NAME</code></dt><dd>이미지 삭제하기</dd>
<dt><code>docker system prune -a</code></dt><dd>실행 중이지 않은 모든 컨테이너와 이미지를 삭제 (주로
시스템 공간 확보를 위해 사용)</dd>
<dt><code>docker history IMAGE</code></dt><dd>특정 이미지의 히스토리 조회</dd>
</dl>
</div>
</div>
<div id="outline-container-orgf933a19" class="outline-2">
<h2 id="orgf933a19">멀티 컨테이너 커스텀 네트워크</h2>
<div class="outline-text-2" id="text-orgf933a19">
<dl class="org-dl">
<dt><code>docker network create NETWORK_NAME</code></dt><dd>네트워크 생성하기</dd>
<dt><code>docker run -d --net NETWORK_NAME --name NAME IMAGE_NAME</code></dt><dd>특정 네트워크를 사용하는 특정 이름의 이미지를 데몬 모드로 실행시키기</dd>
<dt><code>docker network prune</code></dt><dd>기본 네트워크를 제외하고 다 지우기</dd>
</dl>
</div>
</div>
<div id="outline-container-orgec75188" class="outline-2">
<h2 id="orgec75188">기타 사용법</h2>
<div class="outline-text-2" id="text-orgec75188">
</div>
<div id="outline-container-org5c0d70b" class="outline-3">
<h3 id="org5c0d70b">모든 컨테이너 중지</h3>
<div class="outline-text-3" id="text-org5c0d70b">
<div class="org-src-container">
<pre class="src src-sh">docker <span style="color: #ECBE7B;">kill</span> $<span style="color: #51afef;">(</span>docker ps -q<span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgc7571cc" class="outline-3">
<h3 id="orgc7571cc">모든 컨테이너 삭제</h3>
<div class="outline-text-3" id="text-orgc7571cc">
<div class="org-src-container">
<pre class="src src-sh">docker <span style="color: #ECBE7B;">rm</span> $<span style="color: #51afef;">(</span>docker ps -a -q<span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org582c066" class="outline-2">
<h2 id="org582c066">활용 예제</h2>
<div class="outline-text-2" id="text-org582c066">
</div>
<div id="outline-container-orga1a598f" class="outline-3">
<h3 id="orga1a598f">구 버전 MongoDB CLI 가 필요할 때</h3>
<div class="outline-text-3" id="text-orga1a598f">
<div class="org-src-container">
<pre class="src src-bash">docker run --rm -it mongo:2 /bin/bash
</pre>
</div>
<p>
개인적으로 mongo 2.x 가 필요할 때는 이걸로 몽고 2.x 이미지의 셸을 띄워서 안에서
<code>mongo</code> 커맨드를 사용해 접속한다.
물론 셸을 띄우지 않고 바로 <code>mongo</code> 커맨드를 이용해도 된다.
</p>
<div class="org-src-container">
<pre class="src src-bash">docker run --rm -it mongo:2 mongo --host db.foo.bar
</pre>
</div>
<p>
그냥 2.x를 안 쓰는 것이 가장 좋겠지만 그놈의 레거시가&#x2026;😭
</p>
</div>
</div>
</div>
<div id="outline-container-org67f00d3" class="outline-2">
<h2 id="org67f00d3">공간 비우기</h2>
<div class="outline-text-2" id="text-org67f00d3">
<p>
No space left 에러 혹은 디스크 공간 부족으로 인해 이미지들이나 각종 컨테이너를
삭제해야 할 경우 아래의 커맨드를 이용할 수 있다.
</p>
<div class="org-src-container">
<pre class="src src-bash">docker <span style="color: #ECBE7B;">rm</span> $<span style="color: #51afef;">(</span>docker ps -q -f <span style="color: #98be65;">'status=exited'</span><span style="color: #51afef;">)</span>
docker rmi $<span style="color: #51afef;">(</span>docker images -q -f <span style="color: #98be65;">"dangling=true"</span><span style="color: #51afef;">)</span>
docker volume <span style="color: #ECBE7B;">rm</span> $<span style="color: #51afef;">(</span>docker volume <span style="color: #ECBE7B;">ls</span> -qf <span style="color: #dcaeea;">dangling</span>=true<span style="color: #51afef;">)</span>
</pre>
</div>
<p>
위 커맨드는 종료된 컨테이너와 사용되지 않는 이미지와 볼륨을 순차적으로 지우는 명령이다.
</p>
</div>
</div>
<div id="outline-container-org4d443c1" class="outline-2">
<h2 id="org4d443c1">기타 메모</h2>
<div class="outline-text-2" id="text-org4d443c1">
</div>
<div id="outline-container-orga16eeb6" class="outline-3">
<h3 id="orga16eeb6">컨테이너에서 호스트 포트에 접근하기(macOS)</h3>
<div class="outline-text-3" id="text-orga16eeb6">
<p>
네트워크 구현 문제로 호스트에 열려있는 포트들 - 특히 도커에 의해 열리지 않은
포트들 - 에 접근하려면 <code>host.docker.internal</code> 라는 특수한 이름으로 접속할 수 있다.
예를 들어
내 컴퓨터에 MongoDB 를 27017 포트로 열어놓은 상태에서,
리눅스 도커 컨테이너에서 이 MongoDB에 접속하려면
아래와 같은 식의 커맨드를 사용할 수 있다.
</p>
<div class="org-src-container">
<pre class="src src-bash">mongo mongodb://host.docker.internal:27017/dbname
</pre>
</div>
<p>
풀어서 쓴 글인 <a target="_blank" href="https://seorenn.tistory.com/20">🌏Docker에서 macOS 호스트 포트에 접근하기</a> 글을 참고하자.
</p>
</div>
</div>
<div id="outline-container-org4210348" class="outline-3">
<h3 id="org4210348">적당히 시작하기 좋은 이미지들</h3>
<div class="outline-text-3" id="text-org4210348">
<dl class="org-dl">
<dt><code>debian:buster</code></dt><dd>일단 이 글을 쓰는 시점에서 가장 최신의 LTS 데비안
이미지&#x2026;인지는 잘 모르겠지만 하여간 그나마 패키지가 최신이다.</dd>
<dt><code>python:3.x-slim</code></dt><dd>Python 3.x 버전 대의 작은 이미지다.
빌드를 하려면 추가 패키지 설치가 필요하지만 apt-get이 있으므로 안심😋</dd>
<dt><code>alpine</code></dt><dd>그냥 썰렁한 리눅스다.
apt도 없다.
매우 작은 이미지를 만들 거라면 베이스 이미지로 적당할 것 같다.</dd>
</dl>
</div>
</div>
</div>
<div id="outline-container-org0f83cc0" class="outline-2">
<h2 id="org0f83cc0">관련된 글들</h2>
<div class="outline-text-2" id="text-org0f83cc0">
<ul class="org-ul">
<li><a href="dockerfile.html">Dockerfile</a></li>
<li><a href="docker-compose.html">Docker Compose</a></li>
<li><a target="_blank" href="https://seorenn.tistory.com/20">🌏Docker에서 macOS 호스트 포트에 접근하기</a></li>
<li><a target="_blank" href="https://www.44bits.io/ko/post/how-docker-image-work">🌏만들면서 이해하는 도커(Docker) 이미지의 구조</a>: 도커 이미지 빌드 원리와 Overayfs</li>
</ul>
</div>
</div>
</section>
<hr /><div class="backlinks-container">
<h1>이 글을 링크하는 글들</h1>
<div class="article-link">
<div class="article-link-title-block">
<h2><a class="article-link-title" href="/note/dockerfile.html">Dockerfile</a></h2>
<div class="article-link-date">
2020년 4월 15일 수정</div>
</div>
</div>
<div class="article-link">
<div class="article-link-title-block">
<h2><a class="article-link-title" href="/note/docker-compose.html">Docker Compose</a></h2>
<div class="article-link-date">
2020년 4월 15일 수정</div>
</div>
</div>
</div>
<div class="top-ad">
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1071465863344332"
     data-ad-slot="4306465772"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<footer>
Copyright 2019 ~ 2020. Seorenn all rights reserved.
</footer>
</body>
</html>
