<!DOCTYPE html>
<html lang="kr">
<head>
<!-- 2019-12-01 Sun 12:41 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Python 3 Static Typing - Seorenn Static Pages</title>
<meta name="generator" content="Org mode">
<meta name="author" content="Heeseung Seo (Seorenn)">
<meta name="description" content="Python(파이썬) 3 에서 도입된 정적 타이핑 지원 기능을 분석해보는 글">
<meta name="keywords" content="python, 3, static, typing, type, hint, annotation, mypy">
<meta property="og:title" content="Python 3 Static Typing" />
<meta property="og:description" content="Python(파이썬) 3 에서 도입된 정적 타이핑 지원 기능을 분석해보는 글" />
<meta property="og:type" content="website" />
<meta property="og:image" content="https://seorenn.github.io/img/seorenn-logo.png" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Python 3 Static Typing" />
<meta name="twitter:description" content="Python(파이썬) 3 에서 도입된 정적 타이핑 지원 기능을 분석해보는 글" />
<meta name="twitter:image" content="https://seorenn.github.io/img/seorenn-logo.png" />
<meta name="twitter:site" content="@seorenn" />
<meta name="twitter:creator" content="@seorenn" />
<link rel="stylesheet" type="text/css" href="/static/style.css"/>
<link rel="shortcut icon" type="image/x-icon" href="favicon.ico"/>
<link rel="canonical" href="https://seorenn.github.io/python-3-static-typing.html"/>
<link property="og:url" href="https://seorenn.github.io/python-3-static-typing.html"/>
<meta name="google-site-verification" content="YqTFZuthbvGIlDE1dhxiTjZ3m-GfyNs_rsHaOlPKpug" />
<meta name="naver-site-verification" content="ebf6a89968fd9f447c1a77d83e2c4aa9bdbb0345"/>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-44534026-1"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-44534026-1');
</script>
</head>
<body>
<div id="content">
<header>
<h1 class="title">Python 3 Static Typing</h1>
<h2><a href="/">Seorenn Static Pages</a></h2></header><p>
파이썬은 동적 타이핑 언어입니다. 쉽게 말해서, 하나의 변수가 타입에 구애받지 않는
데이터를 가리킬 수 있습니다. 그래서 동적 타이핑은 쉽고 간결한 코드를 만들 수
있기도 합니다.
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #dcaeea;">a</span> = <span style="color: #da8548; font-weight: bold;">100</span>
<span style="color: #dcaeea;">a</span> = <span style="color: #98be65;">"String"</span>
</pre>
</div>
<p>
하지만 동적 타이핑은 변수에 제대로 값이 전달되는 지를 감시할 수 없다는 큰
단점이 있습니다. 예를 들어 특정 함수를 호출할 때 특정 매개변수(parameter)에는 정수가 전달되고 어떤 매개변수에는
문자열이 전달되어야 하는데 이것이 잘못 되었다고 할지라도 실제로 실행시키기
전까진 문제가 있는지 없는지 인터프리터가 파악해 주지 않습니다.
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #51afef;">def</span> <span style="color: #c678dd;">make_double_prev</span>(v):
    <span style="color: #51afef;">return</span> (v * <span style="color: #da8548; font-weight: bold;">2</span>) - <span style="color: #da8548; font-weight: bold;">1</span>

make_double(<span style="color: #da8548; font-weight: bold;">10</span>)
make_double(<span style="color: #98be65;">"test"</span>) <span style="color: #5B6268;"># </span><span style="color: #5B6268;">&#51060; &#53076;&#46300;&#44032; &#49892;&#54665;&#46104;&#50612;&#50556; TypeError &#48156;&#49373;</span>
</pre>
</div>
<p>
반대로 정적 타이핑의 대표적인 언어인 <a href="./swift.html">Swift</a> 언어의 경우 최소한 컴파일 할때 타입이
잘못 되었는지를 경고나 에러로 알려줍니다. 그래서 타입이 맞지 않아서 발생하는
런타임 에러를 미연에 잡을 수 있게 해 줍니다.
</p>
<div class="org-src-container">
<pre class="src src-swift"><span style="color: #51afef;">var</span> name: <span style="color: #c678dd;">String</span> = <span style="color: #98be65;">"Conrad"</span>
<span style="color: #51afef;">var</span> nickname = <span style="color: #98be65;">"Seorenn"</span>
name = <span style="color: #da8548; font-weight: bold;">100</span>    <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#52980;&#54028;&#51068; &#49884; Error &#44032; &#48156;&#49373;</span>
</pre>
</div>
<p>
결국 파이썬에서도 이런 정적 타이핑 기능이 필요하다는 이야기가 적지 않게 들려
왔습니다. 그러다 결국 Python 3 버전에서 정적 타이핑과 비슷한 기능이 소개되기 시작합니다.
</p>

<div id="outline-container-org658c5a5" class="outline-2">
<h2 id="org658c5a5">Type Annotation</h2>
<div class="outline-text-2" id="text-org658c5a5">
<p>
Python의 정적 타이핑은 아직 없습니다.
대신 비슷한 기능이 3.0 부터 시작되어서 Function Annotation(3.0+),
Type Annotation(3.5+), Variable Annotation(3.6+)로 추가되어 왔습니다.
이것들을 전부 뭉뚱그려서 Type Annotation 이라고 대충 부를 수 있으며,
개인적으로는 타입 힌팅이라고 부르겠습니다.
</p>

<p>
문법 자체는 Swift와 비슷합니다.
</p>
<div class="org-src-container">
<pre class="src src-python">variable_name: <span style="color: #c678dd;">type</span>
</pre>
</div>
<p>
예를 들어 특정 변수는 정수형만 가지게 하려는 것이 목적이라면 아래처럼 코딩할 수
있습니다.
</p>
<div class="org-src-container">
<pre class="src src-python">some_value: <span style="color: #c678dd;">int</span> = <span style="color: #da8548; font-weight: bold;">10</span>
</pre>
</div>
<p>
<code>int</code> 라는 키워드가 타입 힌트입니다. 비슷한 방식으로 문자열도 타입 힌트를 줄 수
있습니다.
</p>
<div class="org-src-container">
<pre class="src src-python">some_name: <span style="color: #c678dd;">str</span> = <span style="color: #98be65;">"Conrad"</span>
</pre>
</div>
<p>
함수나 메소드의 매개 변수(parameter) 선언에서도 동일하게 사용할 수 있습니다.
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #51afef;">def</span> <span style="color: #c678dd;">some_work</span>(name: <span style="color: #c678dd;">str</span>):
    <span style="color: #51afef;">pass</span>
</pre>
</div>
<p>
사실 이게 타입의 힌트를 알려주는 가장 기본적이면서도 핵심적인 내용입니다.
</p>
</div>
</div>
<div id="outline-container-org6ddbae1" class="outline-2">
<h2 id="org6ddbae1">어떻게 체크하나?</h2>
<div class="outline-text-2" id="text-org6ddbae1">
<p>
그런데 앞서 정적 타이핑이 아니라 Type Annotation 혹은 타입 힌팅이라고 칭한
이유가 있습니다. Python 은 컴파일이 필요한 언어가 아니기 때문에 미연에 타입을
체크하는 단계를 가질 수가 없기 때문입니다.
</p>

<p>
대신 인터프리터로 실행시키기 이전에 별도의 외부 도구로 타입 힌트들을 체크하는
방법을 도입하고 있습니다.
</p>

<p>
도구 이름은 <code>mypy</code> 입니다. <code>pip</code> 등으로 설치할 수 있습니다.
</p>
<div class="org-src-container">
<pre class="src src-bash">pip install mypy
</pre>
</div>
<p>
설치가 완료되면 CLI 도구로 사용할 수 있습니다. 사용법도 정말 간단합니다.
</p>
<div class="org-src-container">
<pre class="src src-bash">mypy filename.py
</pre>
</div>
<p>
그냥 소스 파일명이나 경로를 넘겨주면 알아서 체크해줍니다. 예를 들어 아래와 같은
내용을 봅시다.
</p>
<div class="org-src-container">
<pre class="src src-python">some_value: <span style="color: #c678dd;">int</span> = <span style="color: #98be65;">"string"</span>
</pre>
</div>
<p>
이 내용의 파일을 <code>mypy</code> 로 체크해보면 아래와 같은 결과가 나옵니다.
</p>
<blockquote>
<p>
somefile.py:1: error: Incompatible types in assignment (expression has type "str", variable has type "int")
</p>
</blockquote>
<p>
이런 식으로 실행시키기 이전에 타입을 제대로 사용하는지 체크할 수 있습니다.
</p>

<p>
하지만 위의 코드를 <code>python</code> 을 이용해 그대로 실행시켜도 아무런 에러가 생기지
않습니다.
파이썬은 아직 정적 타이핑이 없기 때문입니다.
즉 위의 타입 힌트는 <code>mypy</code> 로 타입을 체크할 때만 의미가 있고,
실제로 파이썬 인터프리터로 실행시킬 때는 아무런 의미가 없기 때문입니다.
뭐 그래도 문서화에 도움을 주기 때문에 완전히 무의미한 것은 또 아니기도 합니다.
</p>
</div>
</div>
<div id="outline-container-org5f2cfee" class="outline-2">
<h2 id="org5f2cfee">복잡한 타입의 힌트</h2>
<div class="outline-text-2" id="text-org5f2cfee">
<p>
기본적인 타입은 앞서 살펴본 것처럼 정말 단순하게 타입 이름만 적어주면 됩니다.
하지만 리스트(list)나 사전형(dictionary) 같은 복잡한 타입은 그냥은 안 되고 <code>typing</code> 모듈의 힘을
빌려야 정의가 가능합니다.
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #51afef;">from</span> typing <span style="color: #51afef;">import</span> List

<span style="color: #51afef;">def</span> <span style="color: #c678dd;">some_work_list</span>(values: List):
    <span style="color: #51afef;">pass</span>
</pre>
</div>
<p>
<code>List</code> 는 파이썬의 대표적인 콜렉션으로 아무 타입의 데이터를 하나 이상 담을 수
있는 자료구조입니다. 위 처럼 선언한 결우 이 정의에 맞게 <code>values</code> 패러미터는 아무 데이터를 가지게
되는 단순한 리스트를 받으면 문제가 없다는 식으로 선언됩니다.
</p>

<p>
하지만 콜렉션도 명확한 데이터를 가지는 것이 좋습니다. 아래처럼 말이죠.
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #51afef;">def</span> <span style="color: #c678dd;">some_work_list</span>(values: List[<span style="color: #c678dd;">int</span>]):
    <span style="color: #51afef;">pass</span>
</pre>
</div>
<p>
이제 <code>values</code> 는 정수형(<code>int</code>) 타입의 엘레먼트들로 구성된 리스트만을 인자로 받을
수 있습니다.
</p>

<p>
사전형의 경우도 비슷하게 할 수 있습니다.
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #51afef;">from</span> typing improt Dict

<span style="color: #51afef;">def</span> <span style="color: #c678dd;">some_work_dict</span>(values: Dict[<span style="color: #c678dd;">str</span>, <span style="color: #c678dd;">int</span>]):
    <span style="color: #51afef;">pass</span>
</pre>
</div>
<p>
위 예제는 <code>values</code> 매개변수는 키를 문자열이고 값은 정수형을 가지는 사전형 타입을
가져야 한다는 힌트를 정의하는 코드입니다.
</p>

<p>
이 외에도 <code>Tuple</code> 같은 타입 힌트 등 다양한 타입 힌트를 <code>typing</code> 모듈에서 찾을 수
있습니다.
</p>
</div>
</div>
<div id="outline-container-orgea05611" class="outline-2">
<h2 id="orgea05611">좀 더 복잡한 타입?</h2>
<div class="outline-text-2" id="text-orgea05611">
<p>
리스트나 튜플, 사전형의 경우 값의 타입이 다채로울 수 있습니다. 만약 키는
문자열이지만 값은 아무 타입을 가질 수 있는 사전형 타입 힌트를 정의하려 한다면
아래 처럼 할 수 있습니다.
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #51afef;">from</span> typing <span style="color: #51afef;">import</span> Dict, Any

<span style="color: #51afef;">def</span> <span style="color: #c678dd;">some_work_dict</span>(values: Dict[<span style="color: #c678dd;">str</span>, Any]):
    <span style="color: #51afef;">pass</span>
</pre>
</div>
<p>
<code>Any</code> 라는 특수한 타입 힌트가 쓰였습니다.
아무 타입이라는 의미로 추측이 가능합니다.
Swift에서 쓰이는 Any와 의미가 비슷하기도 하네요.
</p>

<p>
이 방법 외에도,
만약 <code>Any</code> 를 쓰기가 싫은 대신
명확한 몇 가지 타입만을 가지면 된다는 힌트를 주고 싶다면
아래처럼 <code>Union</code> 을 사용할 수도 있습니다.
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #51afef;">from</span> typing <span style="color: #51afef;">import</span> Dict, Union, List

<span style="color: #51afef;">def</span> <span style="color: #c678dd;">some_work_dict</span>(values: Dict[<span style="color: #c678dd;">str</span>, Union[<span style="color: #c678dd;">str</span>, <span style="color: #c678dd;">int</span>, List[<span style="color: #c678dd;">str</span>]]]):
    <span style="color: #51afef;">pass</span>
</pre>
</div>
<p>
여기서 매개변수 <code>values</code> 는 문자열 키와 함께
문자열, 정수, 문자열 리스트를 값으로 선언할 수 있는
타입 힌트를 정의하고 있습니다.
뭔가 복잡해 보이지만 이런 식으로
콜렉션 안에서도 콜렉션 타입을 쓸 수 있다는 것을
같이 볼 수 있는 좋은 예제 같습니다.
</p>
</div>
</div>
<div id="outline-container-orga258242" class="outline-2">
<h2 id="orga258242">Optional?</h2>
<div class="outline-text-2" id="text-orga258242">
<p>
앞서 본 예제들은 NULL 과 비슷한 <code>None</code> 값을 가질 수가 없다는 특징이 있는데
이 값을 가지려면 어떻게 해야할까요?
</p>

<p>
단순하게는 앞서 소개한 <code>Union</code> 을 이용하는 방법이 있습니다.
</p>
<div class="org-src-container">
<pre class="src src-python">some_value: <span style="color: #dcaeea;">Union</span>[<span style="color: #c678dd;">int</span>, <span style="color: #a9a1e1;">None</span>] = <span style="color: #a9a1e1;">None</span>
</pre>
</div>
<p>
위의 코드에서 <code>some_value</code> 변수는 정수형 혹은 None 타입의 값을 가질 수 있습니다.
</p>

<p>
하지만 이를 좀 더 편하게 할 수 있는 것이 있습니다.
바로 <code>Optional</code> 입니다.
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #51afef;">from</span> typing <span style="color: #51afef;">import</span> Optional
some_value: <span style="color: #dcaeea;">Optional</span>[<span style="color: #c678dd;">int</span>] = <span style="color: #a9a1e1;">None</span>
</pre>
</div>
<p>
위 코드에서 <code>some_value</code> 는 <code>int</code> 타입 뿐만 아니라
<code>None</code> 도 값으로 가질 수 있다고 힌트를 명시하고 있습니다.
아무래도 이 방법이 <code>Union</code> 을 사용하는 것 보다는 더 편한 것 같습니다.
</p>
</div>
</div>
<div id="outline-container-org6ee90ed" class="outline-2">
<h2 id="org6ee90ed">기타</h2>
<div class="outline-text-2" id="text-org6ee90ed">
<p>
글이 너무 길어질 것 같아서 참고할 수 있을만한 내용을 간단히 언급하겠습니다.
</p>
<ul class="org-ul">
<li>만약 새로운 타입을 정의하고 싶다면 <code>NewType</code> 에 대해 찾아봅시다.</li>
<li>연관 타입을 정의하고 싶다면 <code>TypeVar</code> 를 찾아봅시다.</li>
<li>함수 타입은 <code>Callable</code> 을 찾아봅시다.</li>
</ul>
<p>
이 외에도 뭔가 너무 많아서 빠트린 게 많을 것 같습니다.
</p>
</div>
</div>
<div id="outline-container-orga83ad1a" class="outline-2">
<h2 id="orga83ad1a">결론</h2>
<div class="outline-text-2" id="text-orga83ad1a">
<p>
안타깝게도 파이썬은 아직 정적 타이핑이 제공된다고 보기에는 힘듭니다.
</p>
<blockquote>
<p>
PEP-484 "No type checking happens at runtime"
</p>
</blockquote>
<p>
사람마다 원하는 바는 다를 것이기에 결론 또한 다를 수 있습니다.
</p>

<p>
저는 적어도 현재의 타입 힌트만 주는 기능은 정적 타이핑이라고 생각하지 않습니다.
최소한 인터프리터가 시작 전 강제로 타입을 체크하도록 하는 것이 필요하겠지만
그렇게 해버리면 퍼포먼스 문제도 생길지도 모르니
당연히 생각처럼 쉽게 되는 일 또한 아니겠지요.
그래서 뭐가 맞다라고 이야기 하기에도 개인적으로 미숙할 뿐입니다.
</p>

<p>
어쨌거나 <code>mypy</code> 라는 외부 도구를 이용해서
정적 타이핑을 흉내낼 수 있다는 점 만으로도
파이썬 프로그래밍의 세계가 좀 더 견고해지리라는 것은 확실합니다.
거기다 몇몇 IDE 에디터들은 이미 mypy로 연동을 하고 있는 수준이기 때문에
편집 단계에서 문제를 미연에 해결하는 것 또한 가능한 수준입니다.
</p>

<p>
뭐&#x2026; 쓸 만 하다는 이야기입니다. :D
</p>
</div>
</div>
<div id="outline-container-org4fa8964" class="outline-2">
<h2 id="org4fa8964">관련글</h2>
<div class="outline-text-2" id="text-org4fa8964">
<ul class="org-ul">
<li><a href="./python.html">Python</a></li>
<li><a href="./swift.html">Swift</a></li>
<li><a target="_blank" href="https://item4.blog/2017-09-14/Python-Typing-with-mypy/">🌏 mypy와 함께하는
Python Typing</a></li>
</ul>
</div>
</div>
<div id="footer"><div id="time">2019년 12월 01일 마지막으로 수정됨</div><div id="copyright">Copyright 2019 Heeseung Seo (Seorenn)</div></div></div>
</body>
</html>
