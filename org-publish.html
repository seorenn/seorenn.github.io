<!DOCTYPE html>
<html lang="kr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Org Publish - Seorenn Static Pages</title>
<meta name="generator" content="Org mode">
<meta name="author" content="Heeseung Seo (Seorenn)">
<meta name="description" content="Org 문서들을 배치로 퍼블리시할 수 있게 해 주는 Org Publish의 설정방법과 사용법을 설명합니다.">
<meta name="keywords" content="org, org-mode, org-publish, publish, html, website, bulk, export, 자동, 익스포트, 퍼블리시, 편찬">
<meta property="og:title" content="Org Publish" />
<meta property="og:description" content="Org 문서들을 배치로 퍼블리시할 수 있게 해 주는 Org Publish의 설정방법과 사용법을 설명합니다." />
<meta property="og:type" content="website" />
<meta property="og:image" content="https://seorenn.github.io/img/seorenn-logo.png" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Org Publish" />
<meta name="twitter:description" content="Org 문서들을 배치로 퍼블리시할 수 있게 해 주는 Org Publish의 설정방법과 사용법을 설명합니다." />
<meta name="twitter:image" content="https://seorenn.github.io/img/seorenn-logo.png" />
<meta name="twitter:site" content="@seorenn" />
<meta name="twitter:creator" content="@seorenn" />
<link rel="stylesheet" type="text/css" href="/static/style.css"/>
<link rel="shortcut icon" type="image/x-icon" href="favicon.ico"/>
<link rel="canonical" href="https://seorenn.github.io/org-publish.html"/>
<link property="og:url" href="https://seorenn.github.io/org-publish.html"/>
<meta name="google-site-verification" content="YqTFZuthbvGIlDE1dhxiTjZ3m-GfyNs_rsHaOlPKpug" />
<meta name="naver-site-verification" content="ebf6a89968fd9f447c1a77d83e2c4aa9bdbb0345"/>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-44534026-1"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-44534026-1');
</script>
</head>
<body>
<script data-ad-client="ca-pub-1071465863344332" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<div id="content">
<header>
<h1 class="title">Org Publish</h1>
<h2><a href="/">Seorenn Static Pages</a></h2></header><nav id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orged38035">소개</a></li>
<li><a href="#orgcaca605">시작하기</a></li>
<li><a href="#org6a805fd">필요한 모듈들</a></li>
<li><a href="#org9161126">기본 설정</a></li>
<li><a href="#orgacfe0bc">Publish 해보기</a></li>
<li><a href="#orgbddcb6e">프로젝트 그룹화하기</a></li>
<li><a href="#org12efcfa">전부 새로 퍼블리시 하기</a></li>
<li><a href="#org1700206">관련글</a></li>
</ul>
</div>
</nav>

<div id="outline-container-orged38035" class="outline-2">
<h2 id="orged38035">소개</h2>
<div class="outline-text-2" id="text-orged38035">
<p>
org-publish는 <a href="emacs.html">Emacs</a>에서 <a href="org-mode.html">Org Mode</a>로 작성된 .org 문서들로 정적 웹사이트를 만들 수 있게
해주는 도구입니다. 쉽게 말해서 특정 디렉토리 안의 .org 파일들을 .html 파일로
익스포트 해서 원하는 디렉토리로 복사해줍니다. 그리고 각종 css나 스크립트, 이미지
등의 파일도 자동으로 복사할 수 있게 도와줍니다.
</p>

<p>
org-publish 를 어떻게 설정하고 사용하는지 살펴봅시다.
</p>
</div>
</div>
<div id="outline-container-orgcaca605" class="outline-2">
<h2 id="orgcaca605">시작하기</h2>
<div class="outline-text-2" id="text-orgcaca605">
<p>
일단 아래와 같은 디렉토리에서 글을 쓴다고 가정합시다.
</p>
<div class="org-src-container">
<pre class="src src-text">~/org/
    static/
        style.css
    img/
        someimage.jpg
    index.org
    foobar.org
    ...
</pre>
</div>
<p>
이 가정에서는 <code>~/org</code> 라는 디렉토리에서 .org 파일로 글을 작성합니다. 그리고 <code>~/org/static</code> 에는
스타일 파일과 미래에 사용할지도 모를 자바스크립트 파일 등을 넣을 예정입니다.
<code>~/org/img</code> 디렉토리는 이름처럼 이미지만 넣을 에정입니다.
</p>

<p>
이 상태로 쓴 글을 아래와 같은 디렉토리 구조로 익스포트 하려는 것을 목적이라 생각해봅시다.
</p>
<div class="org-src-container">
<pre class="src src-text">~/web/
    static/
        style.css
    img/
        someimage.jpg
    index.html
    foobar.html
    ...
</pre>
</div>
<p>
그냥 .org 파일이 .html로 바뀐거 빼곤 이름과 배치가 동일합니다. 이대로 원하는
서버에 올리면 그대로 정적 웹사이트가 서빙되겠네요.
</p>

<p>
위의 목적에 맞게 설정을 해 봅시다.
</p>
</div>
</div>
<div id="outline-container-org6a805fd" class="outline-2">
<h2 id="org6a805fd">필요한 모듈들</h2>
<div class="outline-text-2" id="text-org6a805fd">
<p>
org-publish는 다행히도 별도로 설치할 필요가 없는 확장입니다. Emacs 에 빌트인
되어있기 때문입니다. 단지 몇 가지 모듈은 자동으로 로딩되지 않기 때문에 수동으로
로드해야 됩니다..
</p>
<div class="org-src-container">
<pre class="src src-lisp">(<span style="color: #51afef;">require</span> '<span style="color: #a9a1e1;">ox-publish</span>)
(<span style="color: #51afef;">require</span> '<span style="color: #a9a1e1;">ox-html</span>)
(<span style="color: #51afef;">require</span> '<span style="color: #a9a1e1;">ox-rss</span>)
</pre>
</div>
<p>
여기서 마지막의 <code>ox-rss</code> 모듈은 RSS를 만들기 위한 것이 아니면 필요가 없는데 나중에
필요할지도 몰라서 일단 넣어둔 상태입니다.
</p>

<p>
물론 이걸로는 아무것도 된 것이 없습니다. 이제 거대한 설정 스크립트를 작성해야 합니다.
</p>
</div>
</div>
<div id="outline-container-org9161126" class="outline-2">
<h2 id="org9161126">기본 설정</h2>
<div class="outline-text-2" id="text-org9161126">
<p>
<code>org-publish-project-alist</code> 라는 리스트가 org-publish 의 핵심입니다.
아래는 위의 목적대로 동작하도록 설정하는 스크립트입니다.
</p>
<div class="org-src-container">
<pre class="src src-lisp">(setq org-publish-project-alist
      '((<span style="color: #98be65;">"doc"</span>
         <span style="color: #c678dd;">:base-directory</span> <span style="color: #98be65;">"~/org"</span>
         <span style="color: #c678dd;">:base-extension</span> <span style="color: #98be65;">"org"</span>

         <span style="color: #c678dd;">:publishing-directory</span> <span style="color: #98be65;">"~/web/"</span>

         <span style="color: #c678dd;">:recursive</span> t

         <span style="color: #c678dd;">:with-toc</span> nil
         <span style="color: #c678dd;">:with-title</span> t
         <span style="color: #c678dd;">:with-date</span> t
         <span style="color: #c678dd;">:section-numbers</span> nil
         <span style="color: #c678dd;">:html-doctype</span> <span style="color: #98be65;">"html5"</span>
         <span style="color: #c678dd;">:html-html5-fancy</span> t
         <span style="color: #c678dd;">:html-head-include-default-style</span> nil
         <span style="color: #c678dd;">:html-head-include-scripts</span> nil
         <span style="color: #c678dd;">:htmlized-source</span> t
         )
        (<span style="color: #98be65;">"static"</span>
         <span style="color: #c678dd;">:base-directory</span> <span style="color: #98be65;">"~/org/static"</span>
         <span style="color: #c678dd;">:base-extension</span> <span style="color: #98be65;">"css\\|js\\|png\\|jpg\\|jpeg\\|gif"</span>
         <span style="color: #c678dd;">:publishing-directory</span> <span style="color: #98be65;">"~/web/static"</span>
         <span style="color: #c678dd;">:recursive</span> t
         <span style="color: #c678dd;">:publishing-function</span> org-publish-attachment)
        (<span style="color: #98be65;">"img"</span>
         <span style="color: #c678dd;">:base-directory</span> <span style="color: #98be65;">"~/org/img"</span>
         <span style="color: #c678dd;">:base-extension</span> <span style="color: #98be65;">"png\\|jpg\\|jpeg\\|gif"</span>
         <span style="color: #c678dd;">:publishing-directory</span> <span style="color: #98be65;">"~/web/img"</span>
         <span style="color: #c678dd;">:recursive</span> t
         <span style="color: #c678dd;">:publishing-function</span> org-publish-attachment)))
</pre>
</div>
<p>
위 설정에는 <code>doc</code>, <code>static</code>, <code>img</code> 의 세 가지 프로젝트가 정의되어 있습니다.
이 이름들은 딱히 정해진 규칙은 없고 그냥 제 멋대로 지은 것들입니다.
</p>

<p>
<code>doc</code> 의 내용은 .org 파일들이 위치하는 디렉토리를 어떤 규칙으로 처리하는지에
대한 설정입니다. <code>base-extension</code> 에 명시된 확장자의 파일들을
<code>publishing-directory</code> 에 익스포트합니다. <code>htmlized-source</code> 가 <code>nil</code> 이 아니기
때문에 익스포트는 html 형식으로 하게 됩니다.
</p>

<p>
나머지 <code>static</code> 과 <code>img</code> 의 내용은 특정한 확장자의 파일들을 그대로 복사하도록
하기 위한 규칙들입니다. 특별하게 <code>publishing-function</code> 이 사용되었는데 여기서
사용된 <code>org-publish-attachment</code> 는 말 그대로 첨부용 파일을 그대로 복사하는 용도로 볼 수 있습니다.
</p>
</div>
</div>
<div id="outline-container-orgacfe0bc" class="outline-2">
<h2 id="orgacfe0bc">Publish 해보기</h2>
<div class="outline-text-2" id="text-orgacfe0bc">
<p>
편찬(publish)을 하기 위해서는 <code>org-publish-all</code> 함수를 호출하면 됩니다.
이 함수는 등록된 모든 프로젝트의 설정에 맞게 익스포트하거나 필요한 파일을
복사합니다.
이 함수는 따로 단축키가 정의되어 있지
않으므로 별도로 정의하거나 <code>M-x</code> 키를 누른 후 위 함수를 입력하면 실행시킬 수
있습니다.
만약 <a href="doom-emacs.html">Doom Emacs</a>라면 <code>M-x</code> 대신 <code>SPC :</code> 키를 사용할 수도
있습니다.
</p>

<p>
별 문제가 없다면 이 명령 만으로 목적대로 원하는 디렉토리에 html과 함께 정적
파일들도 복사될 것입니다.
</p>

<p>
당연하겠지만 org-publish 함수들은 모두 변경하지 않은 파일은 아무런 조치를 하지 않습니다.
즉 수정하지 않은 파일은 익스포트가 되지 않습니다.
</p>
</div>
</div>
<div id="outline-container-orgbddcb6e" class="outline-2">
<h2 id="orgbddcb6e">프로젝트 그룹화하기</h2>
<div class="outline-text-2" id="text-orgbddcb6e">
<p>
<code>org-publish-all</code> 의 경우 등록된 모든 프로젝트를 대상으로 익스포트 및 복사
작업을 수행합니다. 하지만 만약 필요에 의해 모든 것이 한번에가 아니라 필요한 것만
골라서 익스포트 하려면 <code>org-publish</code> 함수를 이용할 수 있습니다. 예를 들어 아래
커맨드를 실행시키면 doc 라는 프로젝트만 publish 합니다.
</p>
<div class="org-src-container">
<pre class="src src-lisp">(org-publish <span style="color: #98be65;">"doc"</span>)
</pre>
</div>

<p>
다만 이렇게 하나하나 하기는 귀찮으니 프로젝트를 그룹으로 묶어봅시다.
</p>

<p>
방법은 간단합니다. 지금까지 작성한 방식과 동일하게 역시 프로젝트를 만들되
아래처럼 만들 수 있습니다.
</p>
<div class="org-src-container">
<pre class="src src-lisp">(setq org-publish-project-alist
      '((<span style="color: #98be65;">"doc"</span>
         <span style="color: #c678dd;">:base-directory</span> <span style="color: #98be65;">"~/org"</span>
         <span style="color: #5B6268;">;; </span><span style="color: #5B6268;">...</span>
         )
        (<span style="color: #98be65;">"static"</span>
         <span style="color: #c678dd;">:base-directory</span> <span style="color: #98be65;">"~/org/static"</span>
         <span style="color: #5B6268;">;; </span><span style="color: #5B6268;">...</span>
         )
        (<span style="color: #98be65;">"img"</span>
         <span style="color: #c678dd;">:base-directory</span> <span style="color: #98be65;">"~/org/img"</span>
         <span style="color: #5B6268;">;; </span><span style="color: #5B6268;">...</span>
         )
        (<span style="color: #98be65;">"web"</span> <span style="color: #c678dd;">:components</span> (<span style="color: #98be65;">"doc"</span> <span style="color: #98be65;">"static"</span> <span style="color: #98be65;">"img"</span>))))
</pre>
</div>
<p>
생략한 코드가 많은데, 그냥 앞서 설정했던 내용에서 마지막 한 줄이 더 추가되었다고 보면 됩니다. web 이라는
이름의 프로젝트는 doc, static, img 라는 세 가지 컴포넌트로 구성되어 있다고
정의한 것입니다. 따라서 이 경우 아래 커맨드 한 번이면 doc, static, img 세
프로젝트 모두 publish가 됩니다.
</p>
<div class="org-src-container">
<pre class="src src-lisp">(org-publish <span style="color: #98be65;">"web"</span>)
</pre>
</div>

<p>
참고로 <a href="doom-emacs.html">Doom Emacs</a>에서는 <code>SPC ;</code> 를 누르면 위 커맨드를 쉽게
입력해서 실행시킬 수 있습니다.
</p>

<blockquote>
<p>
개인적으로 컴포넌트를 정의한 프로젝트를 org-publish 혹은 org-publish-all 함수로
편찬할 때 간혹 Emacs 가 멈춰버리는 증상을 종종 겪고 있습니다.
이유는 아직 모르겠습니다.
</p>
</blockquote>
</div>
</div>
<div id="outline-container-org12efcfa" class="outline-2">
<h2 id="org12efcfa">전부 새로 퍼블리시 하기</h2>
<div class="outline-text-2" id="text-org12efcfa">
<p>
org-publish 는 기본적으로 변경된 파일만 업데이트를 하는데 만약 설정을 바꾸는
바람에 모든 글을 다시 익스포트해야 한다면 일일이 파일을 touch 해야 하는 등
번거롭습니다. 이럴 때는 다음 명령어 한 방에 해결이 될 수도 있습니다.
</p>
<div class="org-src-container">
<pre class="src src-lisp">(org-publish <span style="color: #98be65;">"PROJECT_NAME"</span> t)
</pre>
</div>
<p>
Doom Emacs 를 사용 중이라면 <code>SPC ;</code> 단축키로 위 명령을 쉽게 입력해서 실행시킬
수도 있습니다.
</p>
</div>
</div>
<div id="outline-container-org1700206" class="outline-2">
<h2 id="org1700206">관련글</h2>
<div class="outline-text-2" id="text-org1700206">
<ul class="org-ul">
<li><a href="./org-mode.html">Org Mode</a></li>
<li><a href="./emacs.html">Emacs</a></li>
<li><a href="./doom-emacs.html">Doom Emacs</a></li>
<li><a target="_blank" href="https://orgmode.org/manual/Publishing.html">🌏 org-publish 공식 매뉴얼</a></li>
</ul>
</div>
</div>
<div id="footer"><div id="time">2020년 01월 06일 마지막으로 수정됨</div><div id="copyright">Copyright 2019 Heeseung Seo (Seorenn)</div></div></div>
</body>
</html>
