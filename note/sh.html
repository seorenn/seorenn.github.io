<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link rel="stylesheet" href="/static/style.css" />
<title>Bourne Shell - Seorenn</title>
<meta name="twitter:title" content="Bourne Shell" />
<meta name="og:title" content="Bourne Shell" />
<meta name="description" content="본 셸, sh, 가장 기본적인 셸(Shell)에 대한 팁을 정리해 보는 글입니다." />
<meta name="twitter:description" content="본 셸, sh, 가장 기본적인 셸(Shell)에 대한 팁을 정리해 보는 글입니다." />
<meta name="og:description" content="본 셸, sh, 가장 기본적인 셸(Shell)에 대한 팁을 정리해 보는 글입니다." />
<link rel="canonical" href="https://seorenn.github.io/note/sh.html" />
<meta property="og:url" content="https://seorenn.github.io/note/sh.html" />
<link rel="alternate" type="application/rss+xml" title="Seorenn Note Feeds" href="/rss.xml"/>
<link rel="shortcut icon" type="image/x-icon" href="/static/favicon.ico" />
<meta name="twitter:image"content="https://seorenn.github.io/static/seorenn-symbol.png" />
<meta property="og:image" content="https://seorenn.github.io/static/seorenn-symbol.png" />
<meta property="og:image:width" content="520" />
<meta property="og:image:height" content="329" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:site" content="@seorenn" />
<meta name="twitter:creator" content="@seorenn" />
<meta property="og:type" content="article" />
<meta property="og:site_name" content="Seorenn Note" />
<meta property="og:locale" content="ko_KR" />
<meta name="referrer" content="unsafe-url" />
<meta name="robots" content="follow,index" />
<meta name="google-site-verification" content="YqTFZuthbvGIlDE1dhxiTjZ3m-GfyNs_rsHaOlPKpug" />
<meta name="naver-site-verification" content="ebf6a89968fd9f447c1a77d83e2c4aa9bdbb0345" />
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-44534026-1"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-44534026-1');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
</head>
<body>
<header class="top-header">
<div class="logo-container">
<a href="/" title="Seorenn"><img class="site-logo" src="/static/seorenn-logo.png" /></a>
<nav>
<a href="/" title="Home"><img src="/static/icon-home.svg" alt="home" class="menu-icon" /></a>
<a href="/post" title="Post"><img src="/static/icon-post.svg" alt="post" class="menu-icon" /></a>
 <a href="/note" title="Note"><img src="/static/icon-note.svg" alt="note" class="menu-icon" /></a>
</nav>
</div>
</header>
<div class="top-ad-container">
<ins class="adsbygoogle top-ad"
     style="display:block"
     data-ad-client="ca-pub-1071465863344332"
     data-ad-slot="4306465772"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<hr/>
<div class="content-container">
<div class="left-empty">
</div>
<section class="content">
<header>
<h1>Bourne Shell</h1>
<div class="title-date">2020년 4월 13일 수정</div>
</header>
<div id="table-of-contents">
<h2>≡ 목차 (Table of Contents)</h2><div id="text-table-of-contents">
<ul>
<li><a href="#org95442c6">소개</a></li>
<li><a href="#orgde6246b">스크립팅 노트</a>
<ul>
<li><a href="#orgf9e01e4">실행 가능한 스크립트</a></li>
<li><a href="#org7eb6983">if</a></li>
<li><a href="#org115d070">루프</a></li>
<li><a href="#org70e9865">조건식 오퍼레이터</a></li>
<li><a href="#org9402c94">디렉토리 존재 유무 체크</a></li>
<li><a href="#org2234c1d">파일 개수</a></li>
<li><a href="#orgdefe2ea">와일드카드 인자 처리</a></li>
<li><a href="#orge232bcb">에러가 나면 멈추게 하기</a></li>
<li><a href="#org5bb698d">에러 메시지 숨기기</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org95442c6" class="outline-2">
<h2 id="org95442c6">소개</h2>
<div class="outline-text-2" id="text-org95442c6">
<p>
<code>sh</code> 는 Bourne Shell의 축약된 이름으로
유닉스에서 가장 기본적으로 쓰이던 <a href="shell.html">셸</a> 이다.
요즘은 <a href="shell.html">셸</a> 스크립트를 작성할 때를 제외하고는 잘은 쓰이지 않지만,
그 만큼 <a href="shell.html">셸</a> 스크립트의 표준의 역할을 하기도 하는 <a href="shell.html">셸</a>이다.
</p>
</div>
</div>
<div id="outline-container-orgde6246b" class="outline-2">
<h2 id="orgde6246b">스크립팅 노트</h2>
<div class="outline-text-2" id="text-orgde6246b">
<p>
전반적인 기준 없이 그냥 메모 단위로 기록되는 팁이다.
</p>
</div>
<div id="outline-container-orgf9e01e4" class="outline-3">
<h3 id="orgf9e01e4">실행 가능한 스크립트</h3>
<div class="outline-text-3" id="text-orgf9e01e4">
<p>
일반적으로 셸 스크립트를 만들면 셸을 통해서 실행하는 것이 보통이다.
</p>
<div class="org-src-container">
<pre class="src src-sh">sh ./somescript.sh
</pre>
</div>
<p>
하지만 아래처럼 실행하도록 만들 수도 있다.
</p>
<div class="org-src-container">
<pre class="src src-sh">./somescript.sh
</pre>
</div>
<p>
이 경우 해당 스크립트 파일 최상단에 아래와 같은 한 줄을 넣으면 된다.
</p>
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #5B6268;">#</span><span style="color: #5B6268;">!/bin/</span><span style="color: #51afef;">sh</span>
</pre>
</div>
<p>
이 스크립트를 어떤 인터프리터(?)로 실행시킬 지를 명시하는 내용이다.
반드시 첫 줄에 명시되어야만 동작한다.
</p>

<p>
이렇게 바로 sh가 존재하는 경로를 명시해도 되지만
보통은 아래와 같은 스타일을 추천한다.
</p>
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #5B6268;">#</span><span style="color: #5B6268;">!/usr/bin/</span><span style="color: #51afef;">env</span><span style="color: #5B6268;"> sh</span>
</pre>
</div>
<p>
<code>env</code> 라는 도구는 매개변수로 넘긴 도구가 어디에 있는지 찾아서
그 경로를 치환 시키는 도구다.
물론 sh가 아닌 <code>bash</code> 같은 셸을 명시해도 잘 동작해야 정상이다.
</p>

<p>
물론 이것 만으론 끝은 아니고 실행 퍼미션이 있어야 한다.
</p>
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #ECBE7B;">chmod</span> a+x somescript.sh
</pre>
</div>
<p>
이렇게 하면 이 파일은 모든 사용자에게 실행(x) 권한이 주어진다.
따라서 <a href="shell.html">셸</a>에서 바로 실행시킬 수 있게 된다.
</p>

<p>
이후 PATH 환경 변수에 등록된 디렉터리로 옮기거나 해서
좀 더 쉽게 실행시킬 수 있게도 할 수 있다.
필요 없다면 확장자 <code>.sh</code> 를 빼버려도
유닉스나 리눅스, <a href="macos.html">macOS</a> 등에선 아무런 문제가 없다.
</p>
</div>
</div>
<div id="outline-container-org7eb6983" class="outline-3">
<h3 id="org7eb6983">if</h3>
<div class="outline-text-3" id="text-org7eb6983">
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #51afef;">if</span> <span style="color: #51afef;">[</span> condition <span style="color: #51afef;">]</span>
<span style="color: #51afef;">then</span>
    ...
<span style="color: #51afef;">else</span>
    ...
<span style="color: #51afef;">fi</span>
</pre>
</div>
<p>
한 줄로 쓸 때는 세미콜론을 잘 쓰면 된다.
</p>
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #51afef;">if</span> <span style="color: #51afef;">[</span> condition <span style="color: #51afef;">]</span> ; <span style="color: #51afef;">then</span> foo bar; <span style="color: #51afef;">fi</span>;
</pre>
</div>
<p>
NOT은 <code>!</code> 를 쓰면 된다.
</p>
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #51afef;">if</span> <span style="color: #51afef;">[</span> <span style="color: #51afef; font-weight: bold;">!</span> condition <span style="color: #51afef;">]</span>; <span style="color: #51afef;">then</span> foo bar; <span style="color: #51afef;">fi</span>;
</pre>
</div>
<p>
AND 혹은 OR 조건은 아래처럼 할 수도 있다.
</p>
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #51afef;">if</span> <span style="color: #51afef;">{</span> <span style="color: #c678dd;">[</span> condition1 <span style="color: #c678dd;">]</span> &amp;&amp; <span style="color: #c678dd;">[</span> condition2 <span style="color: #c678dd;">]</span> ;<span style="color: #51afef;">}</span> || <span style="color: #51afef;">[</span> condition3 <span style="color: #51afef;">]</span> ; <span style="color: #51afef;">then</span>
    ...
<span style="color: #51afef;">fi</span>
</pre>
</div>
<p>
위 코드는 AND 체크하는 두 식을 중괄호를 이용해 묶은 형태다.
즉 기성 언어라면 <code>(c1 &amp;&amp; c2) || c3</code> 이렇게 표현했을 식이라고 볼 수 있다.
</p>
</div>
</div>
<div id="outline-container-org115d070" class="outline-3">
<h3 id="org115d070">루프</h3>
<div class="outline-text-3" id="text-org115d070">
<p>
<code>for</code> 문을 이용한 현대적인(?) 루프는 아래처럼 쓸 수 있다.
</p>
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #dcaeea;">VALUES</span>=<span style="color: #98be65;">"a\nb\nc"</span>
<span style="color: #51afef;">for</span> VALUE<span style="color: #51afef;"> in</span> $<span style="color: #dcaeea;">VALUES</span>; <span style="color: #51afef;">do</span>
    <span style="color: #ECBE7B;">echo</span> $<span style="color: #dcaeea;">VALUE</span>
<span style="color: #51afef;">done</span>
</pre>
</div>
<p>
출력은 a, b, c가 차례대로 각 한 줄 마다 표시된다.
이 결과로 봐서 <code>VALUES</code> 의 각 값은 개행 문자로 구분되어 있다고 생각할 수 있다.
</p>
</div>
</div>
<div id="outline-container-org70e9865" class="outline-3">
<h3 id="org70e9865">조건식 오퍼레이터</h3>
<div class="outline-text-3" id="text-org70e9865">
<ul class="org-ul">
<li><code>=</code>, <code>!=</code> 문자열이 동일한지, 동일하지 않은지</li>
<li><code>-eq</code>, <code>-ne</code>, <code>-gt</code>, <code>-ge</code>, <code>-lt</code>, <code>-le</code> 차례대로 equal, not equal, greater
than, greater than or equal, less than, less than or equal</li>
<li><code>-a</code>, <code>-o</code> AND와 OR</li>
<li><code>-z</code>, <code>-n</code> 차례대로 문자열의 길이가 0(zero), 반대로 그 이상(not null)</li>
<li><code>-d</code>, <code>-e</code>, <code>-f</code> 디렉토리가 존재하는지, 파일이 존재하는지, 문자열이 파일인지</li>
<li><code>-L</code>, <code>-r</code>, <code>-w</code> 링크인지, 읽기 가능한지, 쓰기 가능한지</li>
<li><code>-s</code> 파일 크기가 0 이상인지</li>
<li><code>-x</code> 파일이 실행 가능한지</li>
<li><code>-nt</code>, <code>-ot</code>, <code>-ef</code> 왼쪽 파일이 오른쪽 파일보다 최신인지, 과거인지, 같은 파일인지</li>
</ul>
</div>
</div>
<div id="outline-container-org9402c94" class="outline-3">
<h3 id="org9402c94">디렉토리 존재 유무 체크</h3>
<div class="outline-text-3" id="text-org9402c94">
<p>
위에서도 정리했지만 <code>-d</code> 플래그를 쓸 수 있다.
</p>
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #51afef;">if</span> <span style="color: #51afef;">[</span> -d <span style="color: #98be65;">"/foo/bar/"</span> <span style="color: #51afef;">]</span> ; <span style="color: #51afef;">then</span>
    ...
<span style="color: #51afef;">fi</span>
</pre>
</div>
<p>
반대로 파일 여부를 파악하려면 <code>-e</code> 혹은 <code>-f</code> 플래그를 쓰면 될 것 같다.
</p>
</div>
</div>
<div id="outline-container-org2234c1d" class="outline-3">
<h3 id="org2234c1d">파일 개수</h3>
<div class="outline-text-3" id="text-org2234c1d">
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #dcaeea;">COUNT</span>=$<span style="color: #51afef;">(</span><span style="color: #ECBE7B;">ls</span> /foo/bar | wc -l<span style="color: #51afef;">)</span>
</pre>
</div>
<p>
참고로 위 코드는 백쿼트(back-quote) <code>`</code> 를 사용하는 것과 비슷한 방식의 커맨드다.
즉 <code>ls /foo/bar | wc -l</code> 커맨드의 실행 결과가 위 변수에 주입된다.
</p>

<p>
위 결과를 이용해 파일이 하나 이상 존재하는지 체크하려면
</p>
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #51afef;">if</span> <span style="color: #51afef;">[</span> <span style="color: #98be65;">"</span><span style="color: #a9a1e1;">$</span><span style="color: #dcaeea;">COUNT</span><span style="color: #98be65;">"</span> -gt <span style="color: #da8548; font-weight: bold;">0</span> <span style="color: #51afef;">]</span> ; <span style="color: #51afef;">then</span>
    ...
<span style="color: #51afef;">fi</span>
</pre>
</div>
<p>
이런 식으로 쓸 수 있다.
</p>
</div>
</div>
<div id="outline-container-orgdefe2ea" class="outline-3">
<h3 id="orgdefe2ea">와일드카드 인자 처리</h3>
<div class="outline-text-3" id="text-orgdefe2ea">
<p>
셸 스크립트에 <code>*.ext</code> 같은 파일 이름 와일드카드를 넘겼을 때
이를 나열하는 방법을 for 커맨드로 표현하면 이렇다.
</p>
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #51afef;">for</span> arg<span style="color: #51afef;"> in</span> <span style="color: #98be65;">"</span><span style="color: #a9a1e1;">$</span><span style="color: #dcaeea;">@</span><span style="color: #98be65;">"</span>
<span style="color: #51afef;">do</span>
    <span style="color: #ECBE7B;">echo</span> $<span style="color: #dcaeea;">arg</span>
    ...
<span style="color: #51afef;">done</span>
</pre>
</div>
<p>
이 경우 <code>arg</code> 에는 각 파일의 경로가 들어있다.
</p>
</div>
</div>
<div id="outline-container-orge232bcb" class="outline-3">
<h3 id="orge232bcb">에러가 나면 멈추게 하기</h3>
<div class="outline-text-3" id="text-orge232bcb">
<p>
셸 스크립트 상단에 아래 한 줄을 넣어두면 에러가 났을 때 스크립트가 멈춘다.
</p>
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #c678dd;">set</span> -e
</pre>
</div>
</div>
</div>
<div id="outline-container-org5bb698d" class="outline-3">
<h3 id="org5bb698d">에러 메시지 숨기기</h3>
<div class="outline-text-3" id="text-org5bb698d">
<p>
에러 메시지는 <code>stderr</code> (2) 파이프로 전달되니 이것을 지옥의 쓰레기통(?)에 던지면 된다.
</p>
<div class="org-src-container">
<pre class="src src-sh">some_shell_command <span style="color: #da8548; font-weight: bold;">2</span>&gt; /dev/null
</pre>
</div>
</div>
</div>
</div>
<div class="mid-ad-container">
<ins class="adsbygoogle mid-ad"
     style="display:block"
     data-ad-client="ca-pub-1071465863344332"
     data-ad-slot="4306465772"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
</section>
<div class="side-ad-container">
<ins class="adsbygoogle side-ad"
     style="display:block"
     data-ad-client="ca-pub-1071465863344332"
     data-ad-slot="4306465772"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
</div>
<hr /><div class="backlinks-container">
<h1>이 글을 링크하는 글들</h1>
<div class="article-link">
<div class="article-link-title-block">
<h2><a class="article-link-title" href="/note/shell.html">셸</a></h2>
<div class="article-link-date">
2020년 4월 13일 수정</div>
</div>
</div>
</div>
<hr/>
<footer>
Copyright 2019 ~ 2020. Seorenn all rights reserved.
</footer>
</body>
</html>
