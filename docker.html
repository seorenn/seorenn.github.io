<!DOCTYPE html>
<html lang="kr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Docker - Seorenn Static Pages</title>
<meta name="generator" content="Org mode">
<meta name="author" content="Heeseung Seo (Seorenn)">
<meta name="description" content="컨테이너 기반 가상화 플랫폼인 도커(Docker)의 간단한 소개 및 몇 가지 팁과 함께 관련 글들을 정리합니다.">
<meta name="keywords" content="도커, docker, usage, prune, clean">
<meta property="og:title" content="Docker" />
<meta property="og:description" content="컨테이너 기반 가상화 플랫폼인 도커(Docker)의 간단한 소개 및 몇 가지 팁과 함께 관련 글들을 정리합니다." />
<meta property="og:type" content="website" />
<meta property="og:image" content="https://seorenn.github.io/img/seorenn-logo.png" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Docker" />
<meta name="twitter:description" content="컨테이너 기반 가상화 플랫폼인 도커(Docker)의 간단한 소개 및 몇 가지 팁과 함께 관련 글들을 정리합니다." />
<meta name="twitter:image" content="https://seorenn.github.io/img/seorenn-logo.png" />
<meta name="twitter:site" content="@seorenn" />
<meta name="twitter:creator" content="@seorenn" />
<link rel="stylesheet" type="text/css" href="/static/style.css"/>
<link rel="shortcut icon" type="image/x-icon" href="favicon.ico"/>
<link rel="canonical" href="https://seorenn.github.io/docker.html"/>
<link property="og:url" href="https://seorenn.github.io/docker.html"/>
<meta name="google-site-verification" content="YqTFZuthbvGIlDE1dhxiTjZ3m-GfyNs_rsHaOlPKpug" />
<meta name="naver-site-verification" content="ebf6a89968fd9f447c1a77d83e2c4aa9bdbb0345"/>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-44534026-1"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-44534026-1');
</script>
</head>
<body>
<div id="content">
<header>
<h1 class="title">Docker</h1>
<h2><a href="/">Seorenn Static Pages</a></h2></header><nav id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgb9b5204">Docker</a></li>
<li><a href="#orge629412">용어</a>
<ul>
<li><a href="#org1dd19d3">이미지(image)</a></li>
<li><a href="#org808afe5">컨테이너(container)</a></li>
</ul>
</li>
<li><a href="#orge59085e">자주 사용하는 커맨드들</a>
<ul>
<li><a href="#org8758607">images</a></li>
<li><a href="#orgc045bda">pull</a></li>
<li><a href="#orgbe279e0">build</a></li>
<li><a href="#org4871775">run</a></li>
<li><a href="#org49c1376">exec</a></li>
<li><a href="#orgc615b4e">logs</a></li>
<li><a href="#org0b8ecbb">ps</a></li>
<li><a href="#org5c88329">stop</a></li>
<li><a href="#org44f2792">kill</a></li>
<li><a href="#org4788715">rm</a></li>
<li><a href="#orgd7f678e">network</a></li>
</ul>
</li>
<li><a href="#org004e7a3">사용법 예제들</a></li>
<li><a href="#org9eaf597">멀티 컨테이너 커스텀 네트워킹</a></li>
<li><a href="#org3653da8">기타 사용법</a>
<ul>
<li><a href="#org2f726fe">모든 컨테이너 중지</a></li>
<li><a href="#org98cb0b0">모든 컨테이너 삭제</a></li>
</ul>
</li>
<li><a href="#org7d7c481">활용 예제</a>
<ul>
<li><a href="#orge1eef85">구 버전 MongoDB CLI 가 필요할 때</a></li>
</ul>
</li>
<li><a href="#orgf8c10fb">공간 비우기</a></li>
<li><a href="#org3b31969">기타 메모</a>
<ul>
<li><a href="#org368a6eb">컨테이너에서 호스트 포트에 접근하기(macOS)</a></li>
<li><a href="#org06f8869">적당히 시작하기 좋은 이미지들</a></li>
</ul>
</li>
<li><a href="#orgac291e3">관련글</a></li>
</ul>
</div>
</nav>

<div id="outline-container-orgb9b5204" class="outline-2">
<h2 id="orgb9b5204">Docker</h2>
<div class="outline-text-2" id="text-orgb9b5204">
<p>
도커는 정석적인 설명으론 컨테이너 기반 가상화 플랫폼이라고 소개하곤 합니다. 물론 이
말만으론 딱이 와닿는 설명은 아닐거예요. 개인적으론 그저 가상으로 OS 수준까지
샌드박스를 만들어 주는 것처럼 보이지만 실제로 가상화는 아닌 (&#x2026;) 멋진 도구라고
생각할 뿐입니다.
</p>

<p>
개인적으로 개발단계나 서비스 단계에서 자주 사용하지만, 특정 유틸리티나 서비스를
사용하기 위해서도 종종 사용합니다.
</p>
</div>
</div>
<div id="outline-container-orge629412" class="outline-2">
<h2 id="orge629412">용어</h2>
<div class="outline-text-2" id="text-orge629412">
</div>
<div id="outline-container-org1dd19d3" class="outline-3">
<h3 id="org1dd19d3">이미지(image)</h3>
<div class="outline-text-3" id="text-org1dd19d3">
<p>
도커에서 실제로 실행시킬 프로그램을 특정한 방식으로 만들어 놓은 것을 의미합니다.
</p>
</div>
</div>
<div id="outline-container-org808afe5" class="outline-3">
<h3 id="org808afe5">컨테이너(container)</h3>
<div class="outline-text-3" id="text-org808afe5">
<p>
이미지를 실제로 실행시킨 인스턴스를 컨테이너라고 부릅니다.
</p>
</div>
</div>
</div>
<div id="outline-container-orge59085e" class="outline-2">
<h2 id="orge59085e">자주 사용하는 커맨드들</h2>
<div class="outline-text-2" id="text-orge59085e">
<p>
개인적으로 자주 사용하는 일부 커맨드만 정리합니다.
</p>
</div>
<div id="outline-container-org8758607" class="outline-3">
<h3 id="org8758607">images</h3>
<div class="outline-text-3" id="text-org8758607">
<p>
이미지 리스트를 볼 수 있습니다.
</p>
</div>
</div>
<div id="outline-container-orgc045bda" class="outline-3">
<h3 id="orgc045bda">pull</h3>
<div class="outline-text-3" id="text-orgc045bda">
<p>
이미지를 다운로드 받습니다. 하지만 <code>run</code> 으로 실행시키면 없는 이미지를 자동으로 다운로드 받기 때문에 그다지 쓸 일이 없는 커맨드입니다.
</p>
</div>
</div>
<div id="outline-container-orgbe279e0" class="outline-3">
<h3 id="orgbe279e0">build</h3>
<div class="outline-text-3" id="text-orgbe279e0">
<p>
자신의 이미지를 빌드합니다. 기본 명세 파일 이름은 <code>Dockerfile</code> 입니다.
</p>
<ul class="org-ul">
<li><code>-f</code> 옵션으로 <code>Dockerfile</code> 대신 다른 이름이나 경로를 지정해 줄 수 있습니다.</li>
<li><code>-t</code> 옵션으로 이미지 이름이나 버전 태그 등을 지정할 수 있습니다.</li>
</ul>
</div>
</div>
<div id="outline-container-org4871775" class="outline-3">
<h3 id="org4871775">run</h3>
<div class="outline-text-3" id="text-org4871775">
<p>
이미지를 실행시킵니다. 컨테이너를 띄운다고 볼 수 있습니다.
</p>
<ul class="org-ul">
<li><code>-d</code> 데몬(백그라운드 프로세스) 모드로 실행합니다.</li>
<li><code>-it</code> 커맨드를 인터랙티브로 실행시킬 수 있습니다.</li>
<li><code>--rm</code> 컨테이너가 종료되면 자동으로 삭제되게 합니다.</li>
<li><code>-p HOST:CONTAINER</code> 호스트 포트와 컨테이너 내부 포트를 연결합니다.</li>
<li><code>-v HOST_CONTAINER</code> 호스트 파일 시스템과 컨테이너 내부 파일 시스템을 연결합니다.</li>
<li><code>--name NAME</code> 컨테이너 이름을 지정합니다.</li>
<li><code>--net NETWORK</code> 특정 네트워크를 사용해서 실행합니다.</li>
</ul>
</div>
</div>
<div id="outline-container-org49c1376" class="outline-3">
<h3 id="org49c1376">exec</h3>
<div class="outline-text-3" id="text-org49c1376">
<p>
실행 중인 컨테이너에 특정 커맨드를 전달합니다.
</p>
<ul class="org-ul">
<li><code>-it</code> 인터랙티브 커맨드를 전달합니다. 즉 실행 중인 컨테이너에서 셸 등을 띄울 때 요긴하게 사용합니다.</li>
</ul>
</div>
</div>
<div id="outline-container-orgc615b4e" class="outline-3">
<h3 id="orgc615b4e">logs</h3>
<div class="outline-text-3" id="text-orgc615b4e">
<p>
컨테이너의 로그를 살펴봅니다.
<code>-f</code> 지속적으로 로그를 살펴봅니다. <code>tail -f</code> 의 옵션과 비슷합니다.
</p>
</div>
</div>
<div id="outline-container-org0b8ecbb" class="outline-3">
<h3 id="org0b8ecbb">ps</h3>
<div class="outline-text-3" id="text-org0b8ecbb">
<p>
실행 중인 컨테이너 리스트를 살펴봅니다.
</p>
<ul class="org-ul">
<li><code>-a</code> 실행 중이던 아니던 모든 컨테이너 리스트를 살펴봅니다.</li>
<li><code>-q</code> 컨테이너 고유번호만을 출력합니다. 다른 커맨드에 인자로 넘길 때 사용할 수 있습니다.</li>
</ul>
</div>
</div>
<div id="outline-container-org5c88329" class="outline-3">
<h3 id="org5c88329">stop</h3>
<div class="outline-text-3" id="text-org5c88329">
<p>
특정 컨테이너들을 종료합니다.
</p>
</div>
</div>
<div id="outline-container-org44f2792" class="outline-3">
<h3 id="org44f2792">kill</h3>
<div class="outline-text-3" id="text-org44f2792">
<p>
특정 컨테이너들을 강제로 종료합니다.
</p>
</div>
</div>
<div id="outline-container-org4788715" class="outline-3">
<h3 id="org4788715">rm</h3>
<div class="outline-text-3" id="text-org4788715">
<p>
특정 컨테이너들을 삭제합니다.
</p>
</div>
</div>
<div id="outline-container-orgd7f678e" class="outline-3">
<h3 id="orgd7f678e">network</h3>
<div class="outline-text-3" id="text-orgd7f678e">
<p>
도커 네트워크를 다루는 하위 명령을 사용합니다.
</p>
<ul class="org-ul">
<li><code>ls</code> 네트워크 리스트를 출력합니다.</li>
<li><code>create NAME</code> 네트워크를 생성합니다.</li>
<li><code>rm NAME</code> 네트워크를 삭제합니다.</li>
<li><code>prune</code> 기본 네트워크를 제외한 모든 네트워크를 삭제합니다.</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org004e7a3" class="outline-2">
<h2 id="org004e7a3">사용법 예제들</h2>
<div class="outline-text-2" id="text-org004e7a3">
<ul class="org-ul">
<li><code>docker images</code> 이미지 리스트 보기</li>
<li><code>docker pull IMAGE_NAME</code> 이미지 다운로드 받기</li>
<li><code>docker build .</code> 현재 디렉토리에 있는 Dockerfile 명세로 빌드하기</li>
<li><code>docker build -t IMAGE_NAME .</code> 이미지를 특정 이름으로 빌드하기</li>
<li><code>docker build -t IMAGE_NAME:TAG_NAME .</code> 태그까지 붙여서 이미지
빌드하기(태그는 옵션)</li>
<li><code>docker -f /foo/bar/some-dockerfile build -t IMAGE_NAME:TAG_NAME .</code> Dockerfile 이 다른 경로에 있거나 혹은 Dockerfile 대신 다른 파일 이름을 사용한다면 이런 식으로 -f 옵션을 쓸 수 있습니다.</li>
<li><code>docker run IMAGE_NAME</code> 특정 이미지 컨테이너 띄우기</li>
<li><code>docker run IMAGE_NAME:TAG_NAME</code> 특정 태그(버전)의 이미지를 띄우기</li>
<li><code>docker run -d IMAGE_NAME</code> 데몬(백그라운드) 모드로 실행하기</li>
<li><code>docker run -d -e ENV=VALUE IMAGE_NAME</code> 특정 환경변수를 전달하며 데몬(백그라운드) 모드로 실행하기</li>
<li><code>docker run --rm -it IMAGE_NAME COMMAND</code> 종료하면 사라지는(&#x2013;rm) 컨테이너로
터미널(-it) 커맨드 실행하기</li>
<li><code>docker run -p HOST_PORT:CONTAINER_PORT COMMAND</code> 호스트 포트와 컨테이너 포트를
연결해서 컨테이너를 띄워서 커맨드 실행하기</li>
<li><code>docker run -v HOST_PATH:CONTAINER_PATH COMMAND</code> 호스트 디렉토리와 컨테이너
디렉토리를 볼륨으로 연결해서 컨테이너를 띄워 커맨드 실행하기(호스트와 데이터
공유 시)</li>
<li><code>docker ps</code> 살아있는(?) 컨테이너 리스트 보기</li>
<li><code>docker ps -a</code> 모든 컨테이너 리스트 보기</li>
<li><code>docker exec -it CONTAINER_ID COMMAND</code> 특정 동작 중인 컨테이너에서 커맨드 실행하기</li>
<li><code>docker logs CONTAINER_ID</code> 로그 보기</li>
<li><code>docker logs CONTAINER_ID --tail 10</code> 로그 마지막 끝 10줄만 보기</li>
<li><code>docker logs -f CONTAINER_ID</code> 로그 갱신 계속 모니터링 하기</li>
<li><code>docker stop CONTINER_ID</code> 컨테이너 중지</li>
<li><code>docker rm CONTAINER_ID</code> 컨테이너 삭제</li>
<li><code>docker rmi IMAGE_NAME</code> 이미지 삭제하기</li>
<li><code>docker system prune -a</code> 실행 중이지 않은 모든 컨테이너와 이미지를 삭제 (주로
시스템 공간 확보를 위해 사용)</li>
<li><code>docker history IMAGE</code> 특정 이미지의 히스토리 조회</li>
</ul>
</div>
</div>
<div id="outline-container-org9eaf597" class="outline-2">
<h2 id="org9eaf597">멀티 컨테이너 커스텀 네트워킹</h2>
<div class="outline-text-2" id="text-org9eaf597">
<ul class="org-ul">
<li><code>docker network create NETWORK_NAME</code> 네트워크 생성하기</li>
<li><code>docker run -d --net NETWORK_NAME --name NAME IMAGE_NAME</code> 특정 네트워크를 사용하는 특정 이름의 이미지를 데몬 모드로 실행시키기</li>
<li><code>docker network prune</code> 기본 네트워크를 제외하고 다 지우기</li>
</ul>
</div>
</div>
<div id="outline-container-org3653da8" class="outline-2">
<h2 id="org3653da8">기타 사용법</h2>
<div class="outline-text-2" id="text-org3653da8">
</div>
<div id="outline-container-org2f726fe" class="outline-3">
<h3 id="org2f726fe">모든 컨테이너 중지</h3>
<div class="outline-text-3" id="text-org2f726fe">
<div class="org-src-container">
<pre class="src src-sh">docker <span style="color: #ECBE7B;">kill</span> $<span style="color: #51afef;">(</span>docker ps -q<span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org98cb0b0" class="outline-3">
<h3 id="org98cb0b0">모든 컨테이너 삭제</h3>
<div class="outline-text-3" id="text-org98cb0b0">
<div class="org-src-container">
<pre class="src src-sh">docker <span style="color: #ECBE7B;">rm</span> $<span style="color: #51afef;">(</span>docker ps -a -q<span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org7d7c481" class="outline-2">
<h2 id="org7d7c481">활용 예제</h2>
<div class="outline-text-2" id="text-org7d7c481">
</div>
<div id="outline-container-orge1eef85" class="outline-3">
<h3 id="orge1eef85">구 버전 MongoDB CLI 가 필요할 때</h3>
<div class="outline-text-3" id="text-orge1eef85">
<div class="org-src-container">
<pre class="src src-bash">docker run --rm -it mongo:2 /bin/bash
</pre>
</div>
<p>
개인적으로 mongo 2.x 가 필요할 때는 이걸로 몽고 2.x 이미지의 셸을 띄워서 안에서
<code>mongo</code> 커맨드를 사용해 접속합니다. 물론 셸을 띄우지 않고 바로 <code>mongo</code> 커맨드를
이용해도 됩니다.
</p>
<div class="org-src-container">
<pre class="src src-bash">docker run --rm -it mongo:2 mongo --host db.foo.bar
</pre>
</div>
<p>
그냥 2.x 를 안 쓰는 것이 가장 좋겠습니다만&#x2026;😭
</p>
</div>
</div>
</div>
<div id="outline-container-orgf8c10fb" class="outline-2">
<h2 id="orgf8c10fb">공간 비우기</h2>
<div class="outline-text-2" id="text-orgf8c10fb">
<p>
No space left 에러 혹은 디스크 공간 부족으로 인해 이미지들이나 각종 컨테이너를
삭제해야 할 경우 아래의 커맨드를 이용할 수 있습니다.
</p>
<div class="org-src-container">
<pre class="src src-bash">docker <span style="color: #ECBE7B;">rm</span> $<span style="color: #51afef;">(</span>docker ps -q -f <span style="color: #98be65;">'status=exited'</span><span style="color: #51afef;">)</span>
docker rmi $<span style="color: #51afef;">(</span>docker images -q -f <span style="color: #98be65;">"dangling=true"</span><span style="color: #51afef;">)</span>
docker volume <span style="color: #ECBE7B;">rm</span> $<span style="color: #51afef;">(</span>docker volume <span style="color: #ECBE7B;">ls</span> -qf <span style="color: #dcaeea;">dangling</span>=true<span style="color: #51afef;">)</span>
</pre>
</div>
<p>
위 커맨드는 종료된 컨테이너와 사용되지 않는 이미지와 볼륨을 순차적으로 지우는 명령입니다.
</p>
</div>
</div>
<div id="outline-container-org3b31969" class="outline-2">
<h2 id="org3b31969">기타 메모</h2>
<div class="outline-text-2" id="text-org3b31969">
</div>
<div id="outline-container-org368a6eb" class="outline-3">
<h3 id="org368a6eb">컨테이너에서 호스트 포트에 접근하기(macOS)</h3>
<div class="outline-text-3" id="text-org368a6eb">
<p>
네트워크 구현 문제로 호스트에 열려있는 포트들 - 특히 도커에 의해 열리지 않은
포트들 - 에 접근하려면 <code>host.docker.internal</code> 라는 특수한 이름으로 접속하면 됩니다.
예를 들어 내 컴퓨터에 MongDB 를 27017 포트로 열어놓은 상태에서, 리눅스 도커
컨테이너에서 이 MongoDB에 접속하려면 아래와 같은 식의 커맨드를 사용할 수
있습니다.
</p>
<div class="org-src-container">
<pre class="src src-bash">mongo mongodb://host.docker.internal:27017/dbname
</pre>
</div>
<p>
풀어서 쓴 글인 <a target="_blank" href="https://seorenn.tistory.com/20">🌏 Docker에서 macOS 호스트 포트에 접근하기</a> 글을 참고해도 좋을 것 같습니다.
</p>
</div>
</div>
<div id="outline-container-org06f8869" class="outline-3">
<h3 id="org06f8869">적당히 시작하기 좋은 이미지들</h3>
<div class="outline-text-3" id="text-org06f8869">
<ul class="org-ul">
<li><code>debian:buster</code> 일단 이 글을 쓰는 시점에서 가장 최신의 LTS 데비안
이미지&#x2026;인지는 잘 모르겠지만 하여간 그나마 패키지가 최신입니다.</li>
<li><code>python:3.x-slim</code> Python 3.x 버전대의 작은 이미지입니다. 빌드를 하려면 추가
패키지 설치가 필요하지만 apt-get이 있으므로 안심😋</li>
<li><code>alpine</code> 그냥 썰렁한 리눅스입니다. apt도 없어요. 매우 작은 이미지를 만들거라면
베이스 이미지로 적당할지도 모릅니다.</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgac291e3" class="outline-2">
<h2 id="orgac291e3">관련글</h2>
<div class="outline-text-2" id="text-orgac291e3">
<ul class="org-ul">
<li><a href="dockerfile.html">Dockerfile</a></li>
<li><a href="docker-compose.html">Docker Compose</a></li>
<li><a target="_blank" href="https://seorenn.tistory.com/20">🌏 Docker에서 macOS 호스트 포트에 접근하기</a></li>
<li><a target="_blank" href="https://www.44bits.io/ko/post/how-docker-image-work">🌏 만들면서 이해하는 도커(Docker) 이미지의 구조</a>: 도커 이미지 빌드 원리와 Overayfs</li>
</ul>
</div>
</div>
<div id="footer"><div id="time">2020년 01월 06일 마지막으로 수정됨</div><div id="copyright">Copyright 2019 Heeseung Seo (Seorenn)</div></div></div>
</body>
</html>
